% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Assignment 1},
  pdfauthor={Johnsen},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Assignment 1}
\author{Johnsen}
\date{2022-10-01}

\begin{document}
\maketitle

\hypertarget{projekt-1-wind-power-forecast}{%
\subsection{Projekt 1: Wind Power
Forecast}\label{projekt-1-wind-power-forecast}}

\hypertarget{descriptive-statistics}{%
\subsubsection{Descriptive Statistics}\label{descriptive-statistics}}

\hypertarget{read-the-data-tuno.txt-into-r}{%
\paragraph{Read the data tuno.txt into
R}\label{read-the-data-tuno.txt-into-r}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{D }\OtherTok{\textless{}{-}} \FunctionTok{read.table}\NormalTok{(}\StringTok{"tuno.txt"}\NormalTok{, }\AttributeTok{header=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{sep=}\StringTok{" "}\NormalTok{, }
                \AttributeTok{as.is=}\ConstantTok{TRUE}\NormalTok{)}

\NormalTok{D}\SpecialCharTok{$}\NormalTok{date }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2003{-}01{-}01"}\NormalTok{)}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{+}\NormalTok{D}\SpecialCharTok{$}\NormalTok{r.day}
\NormalTok{D}\SpecialCharTok{$}\NormalTok{pow.obs.norm }\OtherTok{\textless{}{-}}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{pow.obs}\SpecialCharTok{/}\DecValTok{5000}
\end{Highlighting}
\end{Shaded}

\hypertarget{make-a-graphical-presentation-of-data-or-parts-of-the-data-and-present-some-summary-statistics.}{%
\paragraph{Make a graphical presentation of data or parts of the data,
and present some summary
statistics.}\label{make-a-graphical-presentation-of-data-or-parts-of-the-data-and-present-some-summary-statistics.}}

Summary statistics:

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Dimensions of D (number of rows and columns)}
\FunctionTok{dim}\NormalTok{(D)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 288   8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#  Column/variable names}
\FunctionTok{names}\NormalTok{(D)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "r.day"        "month"        "day"          "pow.obs"      "ws30"        
## [6] "wd30"         "date"         "pow.obs.norm"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# The first rows/observations}
\FunctionTok{head}\NormalTok{(D)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   r.day month day   pow.obs     ws30      wd30       date pow.obs.norm
## 1     1     1   1  243.0278 6.723611 4.0343405 2003-01-01   0.04860556
## 2     2     1   2 2780.0137 4.272603 2.1365208 2003-01-02   0.55600274
## 3     3     1   3 2118.6164 4.272603 1.6240318 2003-01-03   0.42372329
## 4     4     1   4 1660.8767 6.541096 0.2269022 2003-01-04   0.33217534
## 5     5     1   5 1872.7945 9.713699 5.3161852 2003-01-05   0.37455890
## 6     6     1   6 3212.2603 8.161644 0.9522963 2003-01-06   0.64245205
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# The last rows/observations}
\FunctionTok{tail}\NormalTok{(D)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     r.day month day   pow.obs      ws30      wd30       date pow.obs.norm
## 283   299    10  26  787.0000  9.323288 0.3152175 2003-10-26   0.15740000
## 284   300    10  27 1869.6438 11.280137 5.2411088 2003-10-27   0.37392877
## 285   301    10  28 2551.5205 12.623973 4.7614043 2003-10-28   0.51030411
## 286   302    10  29 2564.5616 11.154795 3.6750237 2003-10-29   0.51291233
## 287   303    10  30  449.5205  5.714384 3.0080934 2003-10-30   0.08990411
## 288   304    10  31  781.8082  6.102740 3.0877370 2003-10-31   0.15636164
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Selected summary statistics}
\FunctionTok{summary}\NormalTok{(D)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      r.day            month             day           pow.obs        
##  Min.   :  1.00   Min.   : 1.000   Min.   : 1.00   Min.   :   0.123  
##  1st Qu.: 78.75   1st Qu.: 3.000   1st Qu.: 8.00   1st Qu.: 254.158  
##  Median :156.50   Median : 6.000   Median :15.00   Median : 964.123  
##  Mean   :154.30   Mean   : 5.594   Mean   :15.47   Mean   :1381.196  
##  3rd Qu.:229.25   3rd Qu.: 8.000   3rd Qu.:23.00   3rd Qu.:2196.579  
##  Max.   :304.00   Max.   :10.000   Max.   :31.00   Max.   :4681.062  
##       ws30             wd30               date             pow.obs.norm      
##  Min.   : 1.139   Min.   :0.000095   Min.   :2003-01-01   Min.   :0.0000247  
##  1st Qu.: 5.779   1st Qu.:2.474999   1st Qu.:2003-03-19   1st Qu.:0.0508315  
##  Median : 8.498   Median :4.079297   Median :2003-06-05   Median :0.1928247  
##  Mean   : 9.112   Mean   :3.602390   Mean   :2003-06-03   Mean   :0.2762392  
##  3rd Qu.:11.202   3rd Qu.:4.945443   3rd Qu.:2003-08-17   3rd Qu.:0.4393158  
##  Max.   :24.950   Max.   :6.274642   Max.   :2003-10-31   Max.   :0.9362123
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Another type of summary of the dataset}
\FunctionTok{str}\NormalTok{(D)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    288 obs. of  8 variables:
##  $ r.day       : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ month       : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ day         : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ pow.obs     : num  243 2780 2119 1661 1873 ...
##  $ ws30        : num  6.72 4.27 4.27 6.54 9.71 ...
##  $ wd30        : num  4.034 2.137 1.624 0.227 5.316 ...
##  $ date        : Date, format: "2003-01-01" "2003-01-02" ...
##  $ pow.obs.norm: num  0.0486 0.556 0.4237 0.3322 0.3746 ...
\end{verbatim}

Visualization of the three relevant variables:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{meltD }\OtherTok{\textless{}{-}}\NormalTok{ D }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{r.day, }\SpecialCharTok{{-}}\NormalTok{month, }\SpecialCharTok{{-}}\NormalTok{day, }\SpecialCharTok{{-}}\NormalTok{pow.obs) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{melt}\NormalTok{(}\AttributeTok{id.vars =} \StringTok{"date"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(meltD)}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ value, }\AttributeTok{fill =}\NormalTok{ variable), }\AttributeTok{colour =} \StringTok{"white"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ variable, }\AttributeTok{scales =} \StringTok{"free"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{fill =} \StringTok{""}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-4-1.pdf}

Correlation analysis

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{D }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(pow.obs.norm, wd30, ws30) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{cor}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pheatmap}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-5-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{date, D}\SpecialCharTok{$}\NormalTok{pow.obs, }\AttributeTok{type =} \StringTok{\textquotesingle{}l\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Date"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Average daily power production [kW]"}\NormalTok{, }
     \AttributeTok{main =} \StringTok{\textquotesingle{}Development in average daily power production over time\textquotesingle{}}\NormalTok{, }\AttributeTok{cex.main =} \FloatTok{0.8}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{)}
\FunctionTok{hist}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{pow.obs, }\AttributeTok{xlab=}\StringTok{"Power production [kW]"}\NormalTok{, }\AttributeTok{main=}\StringTok{\textquotesingle{}Distribution of average daily power production\textquotesingle{}}\NormalTok{, }\AttributeTok{cex.main=}\FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-5-2.pdf}

Outlier analysis

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{outlierFUN }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(data, quantiles)\{}
\NormalTok{  v }\OtherTok{\textless{}{-}} \FunctionTok{quantile}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{probs =}\NormalTok{ quantiles)}
\NormalTok{  IQR }\OtherTok{\textless{}{-}}\NormalTok{ v[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ v[}\DecValTok{1}\NormalTok{]}
\NormalTok{  outliers }\OtherTok{\textless{}{-}}\NormalTok{ ( ( data }\SpecialCharTok{\textless{}}\NormalTok{ (v[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{{-}} \FloatTok{1.5} \SpecialCharTok{*}\NormalTok{ IQR) ) }\SpecialCharTok{|}\NormalTok{ ( data }\SpecialCharTok{\textgreater{}}\NormalTok{ (v[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{+} \FloatTok{1.5} \SpecialCharTok{*}\NormalTok{ IQR) ) ) }\SpecialCharTok{*}\NormalTok{ data}
  \FunctionTok{return}\NormalTok{ (outliers)}
\NormalTok{\}}
\NormalTok{D}\SpecialCharTok{$}\NormalTok{outlierws30 }\OtherTok{\textless{}{-}} \FunctionTok{outlierFUN}\NormalTok{(}\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{ws30, }\AttributeTok{quantiles =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.25}\NormalTok{,}\FloatTok{0.75}\NormalTok{))}
\DocumentationTok{\#\#\#              }\AlertTok{\#\#\#}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{date, D}\SpecialCharTok{$}\NormalTok{ws30, }\AttributeTok{type =} \StringTok{\textquotesingle{}l\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Date"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Wind speeds [m/s]"}\NormalTok{, }\AttributeTok{cex.main =} \FloatTok{0.8}\NormalTok{, }\AttributeTok{col=}\DecValTok{1}\NormalTok{,}
     \AttributeTok{main=}\StringTok{\textquotesingle{}Development in wind speeds over time\textquotesingle{}}\NormalTok{)}
\FunctionTok{points}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{date ,}\AttributeTok{y =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{outlierws30, }\AttributeTok{type =} \StringTok{\textquotesingle{}p\textquotesingle{}}\NormalTok{, }\AttributeTok{pch =} \DecValTok{19}\NormalTok{, }\AttributeTok{col =} \StringTok{"red"}\NormalTok{, }\AttributeTok{cex =} \FloatTok{0.25}\NormalTok{)}
\FunctionTok{hist}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{ws30, }\AttributeTok{xlab=}\StringTok{"Wind speeds [m/s]"}\NormalTok{, }\AttributeTok{main=}\StringTok{\textquotesingle{}Distribution of wind speeds\textquotesingle{}}\NormalTok{, }\AttributeTok{cex.main =} \FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-6-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{date, D}\SpecialCharTok{$}\NormalTok{wd30, }\AttributeTok{type =} \StringTok{\textquotesingle{}l\textquotesingle{}}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Date"}\NormalTok{, }\AttributeTok{ylab=}\FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Wind direction. N = 0, E = "}\NormalTok{, pi}\SpecialCharTok{/}\DecValTok{2}\NormalTok{)), }\AttributeTok{col=}\DecValTok{1}\NormalTok{,}
     \AttributeTok{main=}\StringTok{\textquotesingle{}Development in wind directions over time\textquotesingle{}}\NormalTok{, }\AttributeTok{cex.main =} \FloatTok{0.8}\NormalTok{)}
\FunctionTok{lines}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{date, }\FunctionTok{replicate}\NormalTok{(}\FunctionTok{length}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{date), }\DecValTok{3}\SpecialCharTok{*}\NormalTok{pi}\SpecialCharTok{/}\DecValTok{2}\NormalTok{), }\AttributeTok{type=}\StringTok{\textquotesingle{}l\textquotesingle{}}\NormalTok{, }\AttributeTok{col=}\DecValTok{2}\NormalTok{) }\CommentTok{\#W}
\FunctionTok{lines}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{date, }\FunctionTok{replicate}\NormalTok{(}\FunctionTok{length}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{date), pi), }\AttributeTok{type=}\StringTok{\textquotesingle{}l\textquotesingle{}}\NormalTok{, }\AttributeTok{col=}\DecValTok{3}\NormalTok{) }\CommentTok{\#S}
\FunctionTok{lines}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{date, }\FunctionTok{replicate}\NormalTok{(}\FunctionTok{length}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{date), pi}\SpecialCharTok{/}\DecValTok{2}\NormalTok{), }\AttributeTok{type=}\StringTok{\textquotesingle{}l\textquotesingle{}}\NormalTok{, }\AttributeTok{col=}\DecValTok{4}\NormalTok{) }\CommentTok{\#E}
\FunctionTok{lines}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{date, }\FunctionTok{replicate}\NormalTok{(}\FunctionTok{length}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{date), }\DecValTok{0}\NormalTok{), }\AttributeTok{type=}\StringTok{\textquotesingle{}l\textquotesingle{}}\NormalTok{, }\AttributeTok{col=}\DecValTok{5}\NormalTok{) }\CommentTok{\#N}
\FunctionTok{legend}\NormalTok{(}\StringTok{\textquotesingle{}topleft\textquotesingle{}}\NormalTok{, }\AttributeTok{legend =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}wd30\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}W\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}S\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}E\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}N\textquotesingle{}}\NormalTok{), }\AttributeTok{col =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, }\AttributeTok{lty =} \DecValTok{1}\NormalTok{, }\AttributeTok{cex =} \FloatTok{0.5}\NormalTok{)}
\CommentTok{\#}
\FunctionTok{hist}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{wd30, }\AttributeTok{xlab=}\FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{\textquotesingle{}Wind direction. N = 0, E = \textquotesingle{}}\NormalTok{, }\FunctionTok{frac}\NormalTok{(pi,}\DecValTok{2}\NormalTok{))),}
     \AttributeTok{main=}\StringTok{\textquotesingle{}Distribution of wind directions\textquotesingle{}}\NormalTok{, }\AttributeTok{cex.main =} \FloatTok{0.8}\NormalTok{, }\AttributeTok{freq =} \ConstantTok{TRUE}\NormalTok{) }\DocumentationTok{\#\#\#\#\#hist to show that wind rose is fine}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =} \DecValTok{3}\SpecialCharTok{*}\NormalTok{pi}\SpecialCharTok{/}\DecValTok{2}\NormalTok{, }\AttributeTok{col=}\DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =}\NormalTok{ pi, }\AttributeTok{col=}\DecValTok{3}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =}\NormalTok{ pi}\SpecialCharTok{/}\DecValTok{2}\NormalTok{, }\AttributeTok{col=}\DecValTok{4}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =} \DecValTok{0}\NormalTok{, }\AttributeTok{col=}\DecValTok{5}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{\textquotesingle{}topleft\textquotesingle{}}\NormalTok{, }\AttributeTok{legend =} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}wd30\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}W\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}S\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}E\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}N\textquotesingle{}}\NormalTok{), }\AttributeTok{col =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, }\AttributeTok{lty =} \DecValTok{1}\NormalTok{, }\AttributeTok{cex =} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-6-2.pdf}

Wind rose

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{D}\SpecialCharTok{$}\NormalTok{wd30dg }\OtherTok{\textless{}{-}}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{wd30 }\SpecialCharTok{*} \DecValTok{180}\SpecialCharTok{/}\NormalTok{pi}
\DocumentationTok{\#\#\#wind d}
\NormalTok{intv }\OtherTok{\textless{}{-}} \DecValTok{4}
\CommentTok{\#Dwinter \textless{}{-} D[1:54,] \#for testing the season plots above :) D$date[55] = 2003{-}03{-}01}
\CommentTok{\#Dsummer \textless{}{-} D[140:230,] \#for testing the season plots above :) D$date[140] = 2003{-}06{-}01}
\FunctionTok{windRose}\NormalTok{(D, }\AttributeTok{ws =} \StringTok{"ws30"}\NormalTok{, }\AttributeTok{wd =} \StringTok{"wd30dg"}\NormalTok{, }\AttributeTok{ws2 =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{wd2 =} \ConstantTok{NA}\NormalTok{,}
         \AttributeTok{ws.int =}\NormalTok{ intv, }\AttributeTok{angle =} \DecValTok{30}\NormalTok{, }\AttributeTok{type =} \StringTok{"default"}\NormalTok{, }\AttributeTok{bias.corr =} \ConstantTok{TRUE}\NormalTok{, cols}
         \OtherTok{=} \StringTok{"heat"}\NormalTok{, }\AttributeTok{grid.line =} \FunctionTok{list}\NormalTok{(}\AttributeTok{value=}\DecValTok{4}\NormalTok{, }\AttributeTok{lty=}\DecValTok{4}\NormalTok{, }\AttributeTok{col=}\StringTok{"lightgrey"}\NormalTok{), }\AttributeTok{width =} \DecValTok{1}\NormalTok{, }\AttributeTok{seg =} \ConstantTok{NULL}\NormalTok{, auto.text}
         \OtherTok{=} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{breaks =} \FunctionTok{round}\NormalTok{(}\FunctionTok{max}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{ws30)}\SpecialCharTok{/}\NormalTok{intv), }\AttributeTok{offset =} \DecValTok{10}\NormalTok{, }\AttributeTok{normalise =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{max.freq =}
           \ConstantTok{NULL}\NormalTok{, }\AttributeTok{paddle =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{key.header =} \StringTok{"Wind speed at 30 m"}\NormalTok{, }\AttributeTok{key.footer =} \StringTok{"(m/s)"}\NormalTok{,}
         \AttributeTok{key.position =} \StringTok{"bottom"}\NormalTok{, }\AttributeTok{key =} \FunctionTok{list}\NormalTok{(}\AttributeTok{height=}\DecValTok{2}\NormalTok{), }\AttributeTok{dig.lab =} \DecValTok{3}\NormalTok{, }\AttributeTok{statistic =}
           \StringTok{"prop.count"}\NormalTok{, }\AttributeTok{pollutant =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{annotate =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{angle.scale =}
           \DecValTok{45}\NormalTok{, }\AttributeTok{border =} \StringTok{"black"}\NormalTok{, }\AttributeTok{main=}\StringTok{"Wind directions distribution (at 30 m)"}\NormalTok{,}
         \AttributeTok{cex.main=}\FloatTok{0.75}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-7-1.pdf}

\hypertarget{simple-models}{%
\subsubsection{Simple Models}\label{simple-models}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{load}\NormalTok{(}\StringTok{"dataWindPower.Rdata"}\NormalTok{)}
\FunctionTok{source}\NormalTok{(}\StringTok{"testDistribution.R"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{fit-different-probability-density-models-to-wind-power-wind-speed-and-wind-direction-data.-you-might-consider-different-models-e.g.-beta-gamma-log-normal-and-different-transformations-e.g.-for-wind-power.-it-is-important-that-you-consider-if-the-distributionstransformations-are-reasonable-for-the-data-that-you-try-to-model.}{%
\paragraph{Fit different probability density models to wind power, wind
speed and wind direction data. You might consider different models
e.g.~beta, gamma, log normal, and different transformations e.g.~(for
wind power). It is important that you consider if the
distributions/transformations are reasonable for the data that you try
to
model.}\label{fit-different-probability-density-models-to-wind-power-wind-speed-and-wind-direction-data.-you-might-consider-different-models-e.g.-beta-gamma-log-normal-and-different-transformations-e.g.-for-wind-power.-it-is-important-that-you-consider-if-the-distributionstransformations-are-reasonable-for-the-data-that-you-try-to-model.}}

Fit an exponential, gamma and beta distribution to the observed wind
power data.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{par.exp }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FloatTok{0.2}\NormalTok{, }\AttributeTok{objective =}\NormalTok{ testDistribution,}
                  \AttributeTok{distribution =} \StringTok{"exponential"}\NormalTok{,}
                  \AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{pow.obs.norm)}

\NormalTok{par.exp}\SpecialCharTok{$}\NormalTok{objective}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -82.50862
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{par.beta }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{5}\NormalTok{)}
\NormalTok{                   , }\AttributeTok{objective =}\NormalTok{ testDistribution}
\NormalTok{                   , }\AttributeTok{distribution =} \StringTok{"beta"}
\NormalTok{                   , }\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{pow.obs.norm}
\NormalTok{                   , }\AttributeTok{lower =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.8}\NormalTok{))}
\NormalTok{par.beta}\SpecialCharTok{$}\NormalTok{objective}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -121.6618
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{par.gamma }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{5}\NormalTok{)}
\NormalTok{                    ,}\AttributeTok{objective =}\NormalTok{ testDistribution}
\NormalTok{                    ,}\AttributeTok{distribution =} \StringTok{"gamma"}
\NormalTok{                    ,}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{pow.obs.norm)}
\NormalTok{par.gamma}\SpecialCharTok{$}\NormalTok{objective}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -97.38174
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Sampling from the found beta distribution}
\NormalTok{D}\SpecialCharTok{$}\NormalTok{simdata }\OtherTok{\textless{}{-}} \FunctionTok{rbeta}\NormalTok{(}\FunctionTok{length}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{pow.obs.norm), }\AttributeTok{shape1 =}\NormalTok{ par.beta}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{]}
\NormalTok{                   ,}\AttributeTok{shape2 =}\NormalTok{ par.beta}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{])}
\NormalTok{sam.plot.pow.beta }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(D)}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ pow.obs.norm, }\AttributeTok{y =}\NormalTok{..density..), }\AttributeTok{colour =} \StringTok{"white"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.6}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ simdata, }\AttributeTok{y =}\NormalTok{..density..), }\AttributeTok{alpha =} \FloatTok{0.2}\NormalTok{, }\AttributeTok{fill =} \StringTok{"blue"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{ylim}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{10}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dbeta, }\AttributeTok{n =} \FunctionTok{length}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{pow.obs.norm), }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{shape1 =}\NormalTok{ par.beta}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{],}\AttributeTok{shape2 =}\NormalTok{ par.beta}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]))}

\CommentTok{\#Sampling from the found exp distribution}
\NormalTok{D}\SpecialCharTok{$}\NormalTok{simdata }\OtherTok{\textless{}{-}} \FunctionTok{rexp}\NormalTok{(}\FunctionTok{length}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{pow.obs.norm), }\AttributeTok{rate =}\NormalTok{ par.exp}\SpecialCharTok{$}\NormalTok{par)}
\NormalTok{sam.plot.pow.exp }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(D)}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ pow.obs.norm, }\AttributeTok{y =}\NormalTok{ ..density..))}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ simdata, }\AttributeTok{y =}\NormalTok{ ..density..)}
\NormalTok{                 , }\AttributeTok{alpha =} \FloatTok{0.2}\NormalTok{, }\AttributeTok{fill =} \StringTok{"blue"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dexp, }\AttributeTok{n =} \FunctionTok{length}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{pow.obs.norm), }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{rate =}\NormalTok{ par.exp}\SpecialCharTok{$}\NormalTok{par))}

\CommentTok{\#Sampling from the found gamma distribution}
\NormalTok{D}\SpecialCharTok{$}\NormalTok{simdata }\OtherTok{\textless{}{-}} \FunctionTok{rgamma}\NormalTok{(}\FunctionTok{length}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{pow.obs.norm), }\AttributeTok{shape =}\NormalTok{ par.gamma}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{rate =}\NormalTok{ par.gamma}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{])}
\NormalTok{sam.plot.pow.gamma }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(D)}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ pow.obs.norm, }\AttributeTok{y =}\NormalTok{ ..density..))}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ simdata, }\AttributeTok{y =}\NormalTok{ ..density..)}
\NormalTok{                 , }\AttributeTok{alpha =} \FloatTok{0.2}\NormalTok{, }\AttributeTok{fill =} \StringTok{"blue"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{ylim}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{10}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dgamma, }\AttributeTok{n =} \FunctionTok{length}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{pow.obs.norm), }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{shape =}\NormalTok{ par.gamma}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{rate =}\NormalTok{ par.gamma}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]))}

\FunctionTok{grid.arrange}\NormalTok{(sam.plot.pow.beta, sam.plot.pow.exp, sam.plot.pow.gamma, }\AttributeTok{ncol =} \DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-9-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Remove simulated data from the data frame}
\NormalTok{D }\OtherTok{\textless{}{-}}\NormalTok{ D }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{simdata)}
\end{Highlighting}
\end{Shaded}

For wind speed distributions it is common practice to use the weibull
distribution.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{par.ws30 }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{objective =}\NormalTok{ testDistribution}
\NormalTok{                   , }\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{ws30}
\NormalTok{                   , }\AttributeTok{distribution =} \StringTok{"weibull"}
\NormalTok{                   , }\AttributeTok{lower =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{))}


\FunctionTok{ggplot}\NormalTok{(D)}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ ws30, }\AttributeTok{y =}\NormalTok{ ..count..}\SpecialCharTok{/}\FunctionTok{sum}\NormalTok{(..count..))}
\NormalTok{                 , }\AttributeTok{colour =} \StringTok{"white"}
\NormalTok{                 , }\AttributeTok{bins =} \DecValTok{30}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dweibull, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{shape =}\NormalTok{ par.ws30}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{scale =}\NormalTok{ par.ws30}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-10-1.pdf}

Wind direction are supplied as radians in the dataset, and thus it is
appropriate to fit circular distributions to this variable. Here we
examine a circular normal distribution, wrapped cauchy and a von Mises
distribution.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nll.wrappedNormal }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(p,x)\{}
\NormalTok{  nll }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{log}\NormalTok{(}\FunctionTok{dwrappednormal}\NormalTok{(x, }\AttributeTok{mu =} \FunctionTok{circular}\NormalTok{(p[}\DecValTok{1}\NormalTok{]), }\AttributeTok{rho =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{sd =}\NormalTok{ p[}\DecValTok{2}\NormalTok{])))}
  \FunctionTok{return}\NormalTok{(nll)}
\NormalTok{\}}

\NormalTok{nll.wrappedCauchy }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(p,x)\{}
\NormalTok{  nll }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{log}\NormalTok{(}\FunctionTok{dwrappedcauchy}\NormalTok{(x, }\AttributeTok{mu =} \FunctionTok{circular}\NormalTok{(p[}\DecValTok{1}\NormalTok{]), }\AttributeTok{rho =}\NormalTok{ p[}\DecValTok{2}\NormalTok{])))}
  \FunctionTok{return}\NormalTok{(nll)}
\NormalTok{\}}

\NormalTok{nll.vonMises }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(p,x)\{}
\NormalTok{  nll }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{dvonmises}\NormalTok{(x, }\AttributeTok{mu =} \FunctionTok{circular}\NormalTok{(p[}\DecValTok{1}\NormalTok{]), }\AttributeTok{kappa =}\NormalTok{ p[}\DecValTok{2}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T))}
  \FunctionTok{return}\NormalTok{(nll)}
\NormalTok{\}}

\NormalTok{wrapped.par }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{objective =}\NormalTok{ nll.wrappedNormal, }\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{wd30)}
\NormalTok{wrapped.cauc.par }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\SpecialCharTok{/}\DecValTok{10000}\NormalTok{), }\AttributeTok{lower =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\ConstantTok{Inf}\NormalTok{, }\DecValTok{1}\SpecialCharTok{/}\DecValTok{10000}\NormalTok{), }\AttributeTok{upper =} \FunctionTok{c}\NormalTok{(}\ConstantTok{Inf}\NormalTok{, }\DecValTok{1}\NormalTok{),}
                           \AttributeTok{objective =}\NormalTok{ nll.wrappedCauchy, }\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{wd30)}
\NormalTok{wrapped.vonMises }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{objective =}\NormalTok{ nll.vonMises, }\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{wd30, }\AttributeTok{lower =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1000}\NormalTok{, }\DecValTok{0}\NormalTok{))}

\FunctionTok{ggplot}\NormalTok{(D)}\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}\SpecialCharTok{+}
  \CommentTok{\#geom\_density(aes(x = wd30.centered, y = ..density..), alpha = .8, colour = "white", fill = "red", colour = "white")+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ wd30, }\AttributeTok{y =}\NormalTok{ ..density..), }\AttributeTok{colour =} \StringTok{"white"}\NormalTok{, }\AttributeTok{alpha =}\NormalTok{ .}\DecValTok{4}\NormalTok{, }\AttributeTok{fill =} \StringTok{"blue"}\NormalTok{, }\AttributeTok{bins =} \DecValTok{20}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,pi}\SpecialCharTok{/}\DecValTok{2}\NormalTok{,pi,}\DecValTok{3}\SpecialCharTok{/}\DecValTok{2}\SpecialCharTok{*}\NormalTok{pi,}\DecValTok{2}\SpecialCharTok{*}\NormalTok{pi)}
\NormalTok{                     , }\AttributeTok{labels =}\FunctionTok{c}\NormalTok{(}\StringTok{"0"}\NormalTok{, }\StringTok{"pi/2"}\NormalTok{, }\StringTok{"pi"}\NormalTok{, }\StringTok{"3/2pi"}\NormalTok{, }\StringTok{"2pi"}\NormalTok{))}\SpecialCharTok{+}
  \CommentTok{\#stat\_function(fun = dnorm, n = dim(D)[1], args = list(mean = par.wd30$par[1], sd = par.wd30$par[2]))+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dwrappednormal, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{mu =}\NormalTok{ wrapped.par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{sd =}\NormalTok{ wrapped.par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{colour =} \StringTok{"Wrapped Normal"}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dwrappedcauchy, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{mu =}\NormalTok{ wrapped.cauc.par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{],}\AttributeTok{rho =}\NormalTok{ wrapped.cauc.par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{colour =} \StringTok{"Wrapped Cauchy"}\NormalTok{))}\SpecialCharTok{+}
  \CommentTok{\#stat\_function(fun = dwrappedcauchy, n = dim(D)[1], args = list(mu = {-}1.5748695, rho = 0.2751607), aes(colour = "Wrapped Cauchy2"))+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dvonmises, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{mu =}\NormalTok{ wrapped.vonMises}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{kappa =}\NormalTok{ wrapped.vonMises}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{colour =} \StringTok{"Von Mises"}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Wind Direction"}\NormalTok{, }\AttributeTok{colour =} \StringTok{""}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{scale\_colour\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"yellow"}\NormalTok{, }\StringTok{"red"}\NormalTok{, }\StringTok{"black"}\NormalTok{, }\StringTok{"blue"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-11-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Calculate AICs}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"AIC wrapped normal: "}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{2}\SpecialCharTok{*}\FunctionTok{log}\NormalTok{(}\FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{wrapped.par}\SpecialCharTok{$}\NormalTok{objective     ))}\SpecialCharTok{+}\DecValTok{2}\SpecialCharTok{*}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{), }\StringTok{"|"}
\NormalTok{            ,}\StringTok{"AIC wrapped cauchy: "}\NormalTok{, }\FunctionTok{round}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{2}\SpecialCharTok{*}\FunctionTok{log}\NormalTok{(}\FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{wrapped.cauc.par}\SpecialCharTok{$}\NormalTok{objective))}\SpecialCharTok{+}\DecValTok{2}\SpecialCharTok{*}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{), }\StringTok{"|"}
\NormalTok{            ,}\StringTok{"AIC von Mises: "}\NormalTok{     , }\FunctionTok{round}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{2}\SpecialCharTok{*}\FunctionTok{log}\NormalTok{(}\FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{wrapped.vonMises}\SpecialCharTok{$}\NormalTok{objective))}\SpecialCharTok{+}\DecValTok{2}\SpecialCharTok{*}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "AIC wrapped normal: 1020.5519|AIC wrapped cauchy: 1018.1731|AIC von Mises: 1019.3436"
\end{verbatim}

\hypertarget{conclude-on-the-most-appropriate-model-for-each-variable-also-report-parameters-including-assessment-of-their-uncertainty.-for-models-that-does-not-include-a-transformation-you-should-also-give-an-assessment-of-the-uncertainty-of-the-expected-value-in-the-model.}{%
\paragraph{Conclude on the most appropriate model for each variable,
also report parameters including assessment of their uncertainty. For
models that does not include a transformation you should also give an
assessment of the uncertainty of the expected value in the
model.}\label{conclude-on-the-most-appropriate-model-for-each-variable-also-report-parameters-including-assessment-of-their-uncertainty.-for-models-that-does-not-include-a-transformation-you-should-also-give-an-assessment-of-the-uncertainty-of-the-expected-value-in-the-model.}}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# CI \#\# WIND POWER}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\NormalTok{alpha }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{c }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.5} \SpecialCharTok{*} \FunctionTok{qchisq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha, }\AttributeTok{df =} \DecValTok{1}\NormalTok{))}
\CommentTok{\#likelihood{-}based}
\NormalTok{mle.pow }\OtherTok{\textless{}{-}}\NormalTok{ par.beta}\SpecialCharTok{$}\NormalTok{par}

\NormalTok{pow.fun }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(shape1, shape2, data)\{}
  \FunctionTok{return}\NormalTok{( }\FunctionTok{prod}\NormalTok{( }\FunctionTok{dbeta}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{shape1 =}\NormalTok{ shape1, }\AttributeTok{shape2 =}\NormalTok{ shape2, }\AttributeTok{log =}\NormalTok{ F) ) )}
\NormalTok{\}}

\NormalTok{l.pow.fun }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(shape1, shape2, data)\{}
  \FunctionTok{return}\NormalTok{( }\FunctionTok{sum}\NormalTok{( }\FunctionTok{dbeta}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{shape1 =}\NormalTok{ shape1, }\AttributeTok{shape2 =}\NormalTok{ shape2, }\AttributeTok{log =}\NormalTok{ T) ) )}
\NormalTok{\}}

\NormalTok{CIfun.pow }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(y, }\AttributeTok{first =}\NormalTok{ T)\{}\DocumentationTok{\#\#\#\#\# T for shape, F for scale}
  \ControlFlowTok{if}\NormalTok{(first)\{}
    \FunctionTok{return}\NormalTok{( }\FunctionTok{sum}\NormalTok{( }\FunctionTok{dbeta}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{pow.obs.norm, }\AttributeTok{shape1 =}\NormalTok{ mle.pow[}\DecValTok{1}\NormalTok{], }\AttributeTok{shape =}\NormalTok{ mle.pow[}\DecValTok{2}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T) ) }\SpecialCharTok{{-}}
      \FunctionTok{sum}\NormalTok{( }\FunctionTok{dbeta}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{pow.obs.norm, }\AttributeTok{shape1 =}\NormalTok{ y, }\AttributeTok{shape2 =}\NormalTok{ mle.pow[}\DecValTok{2}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T) ) }\SpecialCharTok{{-}} 
      \FloatTok{0.5} \SpecialCharTok{*} \FunctionTok{qchisq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha, }\AttributeTok{df =} \DecValTok{1}\NormalTok{) )}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{return}\NormalTok{( }\FunctionTok{sum}\NormalTok{( }\FunctionTok{dbeta}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{pow.obs.norm, }\AttributeTok{shape1 =}\NormalTok{ mle.pow[}\DecValTok{1}\NormalTok{], }\AttributeTok{shape =}\NormalTok{ mle.pow[}\DecValTok{2}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T) ) }\SpecialCharTok{{-}}
      \FunctionTok{sum}\NormalTok{( }\FunctionTok{dbeta}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{pow.obs.norm, }\AttributeTok{shape1 =}\NormalTok{ mle.pow[}\DecValTok{1}\NormalTok{], }\AttributeTok{shape2 =}\NormalTok{ y, }\AttributeTok{log =}\NormalTok{ T) ) }\SpecialCharTok{{-}} 
      \FloatTok{0.5} \SpecialCharTok{*} \FunctionTok{qchisq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha, }\AttributeTok{df =} \DecValTok{1}\NormalTok{) ) }
\NormalTok{  \}}
\NormalTok{\}}

\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\NormalTok{shape1s }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.01}\NormalTok{)}
\NormalTok{pow1 }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(}\AttributeTok{X =}\NormalTok{ shape1s, }\AttributeTok{FUN =}\NormalTok{ pow.fun, }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{pow.obs.norm, }\AttributeTok{shape2 =}\NormalTok{ mle.pow[}\DecValTok{2}\NormalTok{])}
\FunctionTok{plot}\NormalTok{(shape1s, pow1}\SpecialCharTok{/}\FunctionTok{max}\NormalTok{(pow1), }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{type =} \StringTok{"l"}\NormalTok{, }\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(alpha)),}
     \AttributeTok{main =} \StringTok{"Parameter value shape1 for beta model of power production"}\NormalTok{)}
\NormalTok{CI.pow1 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.pow, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, mle.pow[}\DecValTok{1}\NormalTok{]), }\AttributeTok{first =}\NormalTok{ T)}\SpecialCharTok{$}\NormalTok{root,}
            \FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.pow, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(mle.pow[}\DecValTok{1}\NormalTok{], }\DecValTok{1}\NormalTok{), }\AttributeTok{first =}\NormalTok{ T)}\SpecialCharTok{$}\NormalTok{root)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{range}\NormalTok{(shape1s), c}\SpecialCharTok{*}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}

\NormalTok{shape2s }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.01}\NormalTok{)}
\NormalTok{pow2 }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(}\AttributeTok{X =}\NormalTok{ shape2s, }\AttributeTok{FUN =}\NormalTok{ pow.fun, }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{pow.obs.norm, }\AttributeTok{shape1 =}\NormalTok{ mle.pow[}\DecValTok{1}\NormalTok{])}
\FunctionTok{plot}\NormalTok{(shape2s, pow2}\SpecialCharTok{/}\FunctionTok{max}\NormalTok{(pow2), }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{type =} \StringTok{"l"}\NormalTok{, }\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(beta)),}
     \AttributeTok{main =} \StringTok{"Parameter value shape2 for beta model of power production"}\NormalTok{)}
\NormalTok{CI.pow2 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.pow, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, mle.pow[}\DecValTok{2}\NormalTok{]), }\AttributeTok{first =}\NormalTok{ F)}\SpecialCharTok{$}\NormalTok{root,}
             \FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.pow, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(mle.pow[}\DecValTok{2}\NormalTok{], }\DecValTok{2}\NormalTok{), }\AttributeTok{first =}\NormalTok{ F)}\SpecialCharTok{$}\NormalTok{root)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{range}\NormalTok{(shape2s), c}\SpecialCharTok{*}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-12-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#wald}
\NormalTok{n }\OtherTok{\textless{}{-}} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{]}
\NormalTok{H.pow.shape1 }\OtherTok{\textless{}{-}} \FunctionTok{hessian}\NormalTok{(l.pow.fun, mle.pow[}\DecValTok{1}\NormalTok{], }\AttributeTok{shape2 =}\NormalTok{ mle.pow[}\DecValTok{2}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{pow.obs.norm)}
\NormalTok{V.pow.shape1 }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{H.pow.shape1)}
\NormalTok{H.pow.shape2 }\OtherTok{\textless{}{-}} \FunctionTok{hessian}\NormalTok{(l.pow.fun, mle.pow[}\DecValTok{2}\NormalTok{], }\AttributeTok{shape1 =}\NormalTok{ mle.pow[}\DecValTok{1}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{pow.obs.norm)}
\NormalTok{V.pow.shape2 }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{H.pow.shape2)}
\NormalTok{wald.pow.shape1 }\OtherTok{\textless{}{-}}\NormalTok{ mle.pow[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{sqrt}\NormalTok{(V.pow.shape1)}
\NormalTok{wald.pow.shape2 }\OtherTok{\textless{}{-}}\NormalTok{ mle.pow[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{sqrt}\NormalTok{(V.pow.shape2)}

\DocumentationTok{\#\# CI \#\# WIND SPEED}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\CommentTok{\#likelihood{-}based}
\NormalTok{mle.ws30.weib }\OtherTok{\textless{}{-}}\NormalTok{ par.ws30}\SpecialCharTok{$}\NormalTok{par}

\NormalTok{ws30.fun }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(shape, scale, data)\{}\DocumentationTok{\#\#\#\#\#}
  \FunctionTok{prod}\NormalTok{(}\FunctionTok{dweibull}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{shape =}\NormalTok{ shape, }\AttributeTok{scale =}\NormalTok{ scale, }\AttributeTok{log =}\NormalTok{ F)}\SpecialCharTok{*}\DecValTok{2}\NormalTok{)}\CommentTok{\#to not get full zeros}
\NormalTok{\}}

\NormalTok{l.ws30.fun }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(shape, scale, data)\{}\DocumentationTok{\#\#\#\#\#}
  \FunctionTok{sum}\NormalTok{(}\FunctionTok{dweibull}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{shape =}\NormalTok{ shape, }\AttributeTok{scale =}\NormalTok{ scale, }\AttributeTok{log =}\NormalTok{ T))}
\NormalTok{\}}

\NormalTok{CIfun.ws30 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(y, }\AttributeTok{shape =}\NormalTok{ T)\{}\DocumentationTok{\#\#\#\#\# T for shape, F for scale}
  \ControlFlowTok{if}\NormalTok{(shape)\{}
    \FunctionTok{sum}\NormalTok{(}\FunctionTok{dweibull}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{ws30, }\AttributeTok{shape =}\NormalTok{ mle.ws30.weib[}\DecValTok{1}\NormalTok{], }\AttributeTok{scale =}\NormalTok{ mle.ws30.weib[}\DecValTok{2}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{{-}}
      \FunctionTok{sum}\NormalTok{(}\FunctionTok{dweibull}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{ws30, }\AttributeTok{shape =}\NormalTok{ y, }\AttributeTok{scale =}\NormalTok{ mle.ws30.weib[}\DecValTok{2}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{{-}} 
      \FloatTok{0.5} \SpecialCharTok{*} \FunctionTok{qchisq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{sum}\NormalTok{(}\FunctionTok{dweibull}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{ws30, }\AttributeTok{shape =}\NormalTok{ mle.ws30.weib[}\DecValTok{1}\NormalTok{], }\AttributeTok{scale =}\NormalTok{ mle.ws30.weib[}\DecValTok{2}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{{-}}
      \FunctionTok{sum}\NormalTok{(}\FunctionTok{dweibull}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{ws30, }\AttributeTok{shape =}\NormalTok{ mle.ws30.weib[}\DecValTok{1}\NormalTok{], }\AttributeTok{scale =}\NormalTok{ y, }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{{-}} 
      \FloatTok{0.5} \SpecialCharTok{*} \FunctionTok{qchisq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha, }\AttributeTok{df =} \DecValTok{1}\NormalTok{) }
\NormalTok{  \}}
\NormalTok{\}}
\NormalTok{shapes }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\FloatTok{3.5}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.1}\NormalTok{)}
\NormalTok{ws30.shape }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(}\AttributeTok{X =}\NormalTok{ shapes, }\AttributeTok{FUN =}\NormalTok{ ws30.fun, }\AttributeTok{scale =}\NormalTok{ mle.ws30.weib[}\DecValTok{2}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{ws30)}
\FunctionTok{plot}\NormalTok{(shapes, ws30.shape}\SpecialCharTok{/}\FunctionTok{max}\NormalTok{(ws30.shape), }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{type =} \StringTok{"l"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"shape, k"}\NormalTok{,}
     \AttributeTok{main =} \StringTok{"Parameter value for shape for weibull model of wind speed"}\NormalTok{)}
\NormalTok{CI.ws30.shape }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.ws30, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, mle.ws30.weib[}\DecValTok{1}\NormalTok{]), }\AttributeTok{shape =}\NormalTok{ T)}\SpecialCharTok{$}\NormalTok{root,}
                   \FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.ws30, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(mle.ws30.weib[}\DecValTok{1}\NormalTok{], }\FloatTok{3.5}\NormalTok{), }\AttributeTok{shape =}\NormalTok{ T)}\SpecialCharTok{$}\NormalTok{root)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{range}\NormalTok{(shapes), c}\SpecialCharTok{*}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}

\NormalTok{scales }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{7}\NormalTok{, }\DecValTok{12}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.1}\NormalTok{)}
\NormalTok{ws30.scale }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(}\AttributeTok{X =}\NormalTok{ scales, }\AttributeTok{FUN =}\NormalTok{ ws30.fun, }\AttributeTok{shape =}\NormalTok{ mle.ws30.weib[}\DecValTok{1}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{ws30)}
\FunctionTok{plot}\NormalTok{(scales, ws30.scale}\SpecialCharTok{/}\FunctionTok{max}\NormalTok{(ws30.scale), }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{type =} \StringTok{"l"}\NormalTok{, }\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"scale, "}\NormalTok{, lambda)),}
     \AttributeTok{main =} \StringTok{"Parameter value for scale for weibull model of wind speed"}\NormalTok{)}
\NormalTok{CI.ws30.scale }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.ws30, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(}\DecValTok{7}\NormalTok{, mle.ws30.weib[}\DecValTok{2}\NormalTok{]), }\AttributeTok{shape =}\NormalTok{ F)}\SpecialCharTok{$}\NormalTok{root,}
                   \FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.ws30, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(mle.ws30.weib[}\DecValTok{2}\NormalTok{], }\DecValTok{12}\NormalTok{), }\AttributeTok{shape =}\NormalTok{ F)}\SpecialCharTok{$}\NormalTok{root)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{range}\NormalTok{(scales), c}\SpecialCharTok{*}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-12-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#wald}
\NormalTok{n }\OtherTok{\textless{}{-}} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{]}
\NormalTok{H.ws30.shape }\OtherTok{\textless{}{-}} \FunctionTok{hessian}\NormalTok{(l.ws30.fun, mle.ws30.weib[}\DecValTok{1}\NormalTok{], }\AttributeTok{scale =}\NormalTok{ mle.ws30.weib[}\DecValTok{2}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{ws30)}
\NormalTok{V.ws30.shape }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{H.ws30.shape)}
\NormalTok{H.ws30.scale }\OtherTok{\textless{}{-}} \FunctionTok{hessian}\NormalTok{(l.ws30.fun, mle.ws30.weib[}\DecValTok{2}\NormalTok{], }\AttributeTok{shape =}\NormalTok{ mle.ws30.weib[}\DecValTok{1}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{ws30)}
\NormalTok{V.ws30.scale }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{H.ws30.scale)}
\NormalTok{wald.ws30.shape }\OtherTok{\textless{}{-}}\NormalTok{ mle.ws30.weib[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{sqrt}\NormalTok{(V.ws30.shape)}
\NormalTok{wald.ws30.scale }\OtherTok{\textless{}{-}}\NormalTok{ mle.ws30.weib[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{sqrt}\NormalTok{(V.ws30.scale)}


\DocumentationTok{\#\# CI \#\# WIND DIRECTION}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\CommentTok{\#likelihood{-}based}
\NormalTok{mle.wd30 }\OtherTok{\textless{}{-}}\NormalTok{ wrapped.cauc.par}\SpecialCharTok{$}\NormalTok{par}

\NormalTok{wd30.fun }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(mu, rho, data)\{}\DocumentationTok{\#\#\#\#\#}
  \FunctionTok{prod}\NormalTok{(}\FunctionTok{dwrappedcauchy}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mu =}\NormalTok{ mu, }\AttributeTok{rho =}\NormalTok{ rho))}
\NormalTok{\}}

\NormalTok{l.wd30.fun }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(mu, rho, data)\{}\DocumentationTok{\#\#\#\#\#}
  \FunctionTok{sum}\NormalTok{( }\FunctionTok{log}\NormalTok{( }\FunctionTok{dwrappedcauchy}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mu =}\NormalTok{ mu, }\AttributeTok{rho =}\NormalTok{ rho) ) )}
\NormalTok{\}}

\NormalTok{CIfun.wd30 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(y, }\AttributeTok{mu =}\NormalTok{ T)\{}\DocumentationTok{\#\#\#\#\# T from mean, F for sigma}
  \ControlFlowTok{if}\NormalTok{(mu)\{}
    \FunctionTok{return}\NormalTok{( }\FunctionTok{sum}\NormalTok{( }\FunctionTok{log}\NormalTok{( }\FunctionTok{dwrappedcauchy}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{wd30, }\AttributeTok{mu =}\NormalTok{ mle.wd30[}\DecValTok{1}\NormalTok{], }\AttributeTok{rho =}\NormalTok{ mle.wd30[}\DecValTok{2}\NormalTok{]) ) ) }\SpecialCharTok{{-}}
      \FunctionTok{sum}\NormalTok{( }\FunctionTok{log}\NormalTok{( }\FunctionTok{dwrappedcauchy}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{wd30, }\AttributeTok{mu =}\NormalTok{ y, }\AttributeTok{rho =}\NormalTok{ mle.wd30[}\DecValTok{2}\NormalTok{]) ) ) }\SpecialCharTok{{-}}
      \FloatTok{0.5} \SpecialCharTok{*} \FunctionTok{qchisq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha, }\AttributeTok{df =} \DecValTok{1}\NormalTok{) )}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{return}\NormalTok{( }\FunctionTok{sum}\NormalTok{( }\FunctionTok{log}\NormalTok{( }\FunctionTok{dwrappedcauchy}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{wd30, }\AttributeTok{mu =}\NormalTok{ mle.wd30[}\DecValTok{1}\NormalTok{], }\AttributeTok{rho =}\NormalTok{ mle.wd30[}\DecValTok{2}\NormalTok{]) ) ) }\SpecialCharTok{{-}} 
      \FunctionTok{sum}\NormalTok{( }\FunctionTok{log}\NormalTok{( }\FunctionTok{dwrappedcauchy}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{wd30, }\AttributeTok{mu =}\NormalTok{ mle.wd30[}\DecValTok{1}\NormalTok{], }\AttributeTok{rho =}\NormalTok{ y) ) ) }\SpecialCharTok{{-}}
      \FloatTok{0.5} \SpecialCharTok{*} \FunctionTok{qchisq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha, }\AttributeTok{df =} \DecValTok{1}\NormalTok{) )}
\NormalTok{  \}}
\NormalTok{\}}

\NormalTok{mus }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{2.5}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.01}\NormalTok{)}
\NormalTok{wd30.mu }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(}\AttributeTok{X =}\NormalTok{ mus, }\AttributeTok{FUN =}\NormalTok{ wd30.fun, }\AttributeTok{rho =}\NormalTok{ mle.wd30[}\DecValTok{2}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{wd30)}
\FunctionTok{plot}\NormalTok{(mus, wd30.mu}\SpecialCharTok{/}\FunctionTok{max}\NormalTok{(wd30.mu), }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{type =} \StringTok{"l"}\NormalTok{, }\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"peak, "}\NormalTok{, mu)),}
     \AttributeTok{main =} \StringTok{"Parameter value for peak for wrapped cauchy model of wind direction"}\NormalTok{)}
\NormalTok{CI.wd30.mu }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.wd30, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{2.5}\NormalTok{, mle.wd30[}\DecValTok{1}\NormalTok{]), }\AttributeTok{mu =}\NormalTok{ T)}\SpecialCharTok{$}\NormalTok{root,}
                \FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.wd30, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(mle.wd30[}\DecValTok{1}\NormalTok{], }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{), }\AttributeTok{mu =}\NormalTok{ T)}\SpecialCharTok{$}\NormalTok{root)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{range}\NormalTok{(mus), c}\SpecialCharTok{*}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}

\NormalTok{rhos }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FloatTok{0.5}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.005}\NormalTok{)}
\NormalTok{wd30.rho }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(}\AttributeTok{X =}\NormalTok{ rhos, }\AttributeTok{FUN =}\NormalTok{ wd30.fun, }\AttributeTok{mu =}\NormalTok{ mle.wd30[}\DecValTok{1}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{wd30)}
\FunctionTok{plot}\NormalTok{(rhos, wd30.rho}\SpecialCharTok{/}\FunctionTok{max}\NormalTok{(wd30.rho), }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{type =} \StringTok{"l"}\NormalTok{, }\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"concentration, "}\NormalTok{, rho)),}
     \AttributeTok{main =} \StringTok{"Parameter value for concentration factor for wrapped cauchy model of wind direction"}\NormalTok{)}
\NormalTok{CI.wd30.rho }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.wd30, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, mle.wd30[}\DecValTok{2}\NormalTok{]), }\AttributeTok{mu =}\NormalTok{ F)}\SpecialCharTok{$}\NormalTok{root,}
                   \FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.wd30, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(mle.wd30[}\DecValTok{2}\NormalTok{], }\FloatTok{0.5}\NormalTok{), }\AttributeTok{mu =}\NormalTok{ F)}\SpecialCharTok{$}\NormalTok{root)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{range}\NormalTok{(rhos), c}\SpecialCharTok{*}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-12-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#wald}
\NormalTok{n }\OtherTok{\textless{}{-}} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{]}
\NormalTok{H.wd30.mu }\OtherTok{\textless{}{-}} \FunctionTok{hessian}\NormalTok{(l.wd30.fun, mle.wd30[}\DecValTok{1}\NormalTok{], }\AttributeTok{rho =}\NormalTok{ mle.wd30[}\DecValTok{2}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{wd30)}
\NormalTok{V.wd30.mu }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{H.wd30.mu)}
\NormalTok{H.wd30.rho }\OtherTok{\textless{}{-}} \FunctionTok{hessian}\NormalTok{(l.wd30.fun, mle.wd30[}\DecValTok{2}\NormalTok{], }\AttributeTok{mu =}\NormalTok{ mle.wd30[}\DecValTok{1}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{wd30)}
\NormalTok{V.wd30.rho }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{H.wd30.rho)}
\NormalTok{wald.wd30.mu }\OtherTok{\textless{}{-}}\NormalTok{ mle.wd30[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{sqrt}\NormalTok{(V.wd30.mu)}
\NormalTok{wald.wd30.rho }\OtherTok{\textless{}{-}}\NormalTok{ mle.wd30[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{sqrt}\NormalTok{(V.wd30.rho)}

\CommentTok{\#All CIs of parameters}
\FunctionTok{round}\NormalTok{( }\FunctionTok{rbind}\NormalTok{( CI.pow1, wald.pow.shape1, CI.pow2, wald.pow.shape2, mle.pow,}
\NormalTok{              CI.ws30.shape, wald.ws30.shape, CI.ws30.scale, wald.ws30.scale, mle.ws30.weib, }
\NormalTok{              CI.wd30.mu, wald.wd30.mu, CI.wd30.rho, wald.wd30.rho, mle.wd30 ), }\AttributeTok{digits =} \DecValTok{3}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                   [,1]   [,2]
## CI.pow1          0.497  0.621
## wald.pow.shape1  0.495  0.619
## CI.pow2          1.296  1.708
## wald.pow.shape2  1.286  1.697
## mle.pow          0.557  1.492
## CI.ws30.shape    1.954  2.295
## wald.ws30.shape  1.952  2.294
## CI.ws30.scale    9.781 10.906
## wald.ws30.scale  9.756 10.879
## mle.ws30.weib    2.123 10.318
## CI.wd30.mu      -1.848 -1.304
## wald.wd30.mu    -1.845 -1.305
## CI.wd30.rho      0.197  0.350
## wald.wd30.rho    0.199  0.352
## mle.wd30        -1.575  0.275
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{alpha }\OtherTok{\textless{}{-}}\NormalTok{ par.beta}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{]; beta }\OtherTok{\textless{}{-}}\NormalTok{ par.beta}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]}
\CommentTok{\#Beta: E[X] = alpha/(alpha + beta), Var[X] = alpha*beta/((alpha+beta)\^{}2*(alpha+beta+1))}
\NormalTok{E.pow.obs }\OtherTok{\textless{}{-}}\NormalTok{ alpha}\SpecialCharTok{/}\NormalTok{(alpha }\SpecialCharTok{+}\NormalTok{ beta)}
\NormalTok{CI.E.pow.obs }\OtherTok{\textless{}{-}}\NormalTok{ alpha}\SpecialCharTok{/}\NormalTok{(alpha }\SpecialCharTok{+}\NormalTok{ beta) }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ alpha}\SpecialCharTok{*}\NormalTok{beta}\SpecialCharTok{/}\NormalTok{((alpha}\SpecialCharTok{+}\NormalTok{beta)}\SpecialCharTok{\^{}}\DecValTok{2}\SpecialCharTok{*}\NormalTok{(alpha}\SpecialCharTok{+}\NormalTok{beta}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)) }\SpecialCharTok{*} \DecValTok{1}\SpecialCharTok{/}\FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{]}
\CommentTok{\#(CI.E.pow.obs \textless{}{-} mean(D$pow.obs.norm) + c({-}1,1) * qnorm(1{-}alpha/2) * sd(D$pow.obs.norm) / dim(D)[1])}

\CommentTok{\#Weibull: E[X] = lambda * gamma(1+1/k); Var[X] = lambda\^{}2*(gamma(1+2/k) {-} (gamma(1+1/k))\^{}2)}
\CommentTok{\#par.ws30$par[2]*gamma(1+1/par.ws30$par[1]) \#mean = lambda * Gamma(1 + 1/k); lambda = scale, k = shape}
\NormalTok{scale }\OtherTok{\textless{}{-}}\NormalTok{ par.ws30}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]; shape }\OtherTok{\textless{}{-}}\NormalTok{ par.ws30}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{]}
\NormalTok{E.ws30 }\OtherTok{\textless{}{-}}\NormalTok{ scale}\SpecialCharTok{*}\FunctionTok{gamma}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\DecValTok{1}\SpecialCharTok{/}\NormalTok{shape)}
\NormalTok{V.ws30 }\OtherTok{\textless{}{-}}\NormalTok{ scale}\SpecialCharTok{\^{}}\DecValTok{2}\SpecialCharTok{*}\NormalTok{(}\FunctionTok{gamma}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\DecValTok{2}\SpecialCharTok{/}\NormalTok{shape) }\SpecialCharTok{{-}}\NormalTok{ (}\FunctionTok{gamma}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\DecValTok{1}\SpecialCharTok{/}\NormalTok{shape))}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{CI.E.ws30 }\OtherTok{\textless{}{-}}\NormalTok{ E.ws30 }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{sqrt}\NormalTok{(V.ws30) }\SpecialCharTok{/} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{] }\CommentTok{\#according to Central Limit Theorem}
\CommentTok{\#(CI.E.ws30 \textless{}{-} mean(D$ws30) + c({-}1,1) * qnorm(1{-}alpha/2) * sd(D$ws30) / dim(D)[1])}

\CommentTok{\#Wrapped Cauchy: E[X] = mu, Var[X] = 1 {-} exp({-}gamma)}
\CommentTok{\#relationship between rho and gamma: gamma = {-}ln(rho)}
\NormalTok{mu }\OtherTok{\textless{}{-}}\NormalTok{ wrapped.cauc.par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{]; gamma }\OtherTok{=} \SpecialCharTok{{-}}\FunctionTok{log}\NormalTok{(wrapped.cauc.par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{])}
\NormalTok{(E.wd30 }\OtherTok{\textless{}{-}}\NormalTok{ mu)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -1.574857
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(V.wd30 }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{{-}} \FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{gamma)) }\CommentTok{\#or 1 {-} rho}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.7248408
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(CI.E.wd30 }\OtherTok{\textless{}{-}}\NormalTok{ E.wd30 }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*}\NormalTok{V.wd30 }\SpecialCharTok{/} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{]) }\CommentTok{\#according to Central Limit Theorem}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -1.576335 -1.573380
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#(CI.E.wd30 \textless{}{-} mle.wd30[1] + c({-}1,1) * qnorm(1{-}alpha/2) * sd(D$wd30) / dim(D)[1]) \#mean(D$wd30) instead gives another result}

\FunctionTok{round}\NormalTok{(}\FunctionTok{rbind}\NormalTok{(}\FunctionTok{c}\NormalTok{(CI.E.pow.obs[}\DecValTok{1}\NormalTok{], }\DecValTok{1}\SpecialCharTok{/}\NormalTok{par.exp}\SpecialCharTok{$}\NormalTok{par, CI.E.pow.obs[}\DecValTok{2}\NormalTok{]) , }\FunctionTok{c}\NormalTok{(CI.E.ws30[}\DecValTok{1}\NormalTok{], E.ws30, CI.E.ws30[}\DecValTok{2}\NormalTok{]) , }\FunctionTok{c}\NormalTok{(CI.E.wd30[}\DecValTok{1}\NormalTok{], mle.wd30[}\DecValTok{1}\NormalTok{], CI.E.wd30[}\DecValTok{2}\NormalTok{])), }\AttributeTok{digits=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##          [,1]     [,2]     [,3]
## [1,]  0.27177  0.27624  0.27203
## [2,]  9.12849  9.13771  9.14694
## [3,] -1.57634 -1.57486 -1.57338
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{))}

\NormalTok{temp1 }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"alpha == "}\NormalTok{, mle.pow[}\DecValTok{1}\NormalTok{]) }\CommentTok{\#par.beta$par[1]}
\NormalTok{temp2 }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"beta == "}\NormalTok{, mle.pow[}\DecValTok{2}\NormalTok{]) }\CommentTok{\#par.beta$par[2]}
\NormalTok{temp }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(temp1, temp2)}

\FunctionTok{ggplot}\NormalTok{(D)}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ pow.obs.norm, }\AttributeTok{y =}\NormalTok{ ..density..), }\AttributeTok{colour=}\StringTok{\textquotesingle{}white\textquotesingle{}}\NormalTok{, }\AttributeTok{alpha=}\FloatTok{0.6}\NormalTok{, }\AttributeTok{bins=}\DecValTok{30}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dbeta, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{shape1 =}\NormalTok{ mle.pow[}\DecValTok{1}\NormalTok{], }\AttributeTok{shape2 =}\NormalTok{ mle.pow[}\DecValTok{2}\NormalTok{]))}\SpecialCharTok{+}
  \FunctionTok{ylim}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{10}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{( }\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{4}\SpecialCharTok{/}\DecValTok{5}\SpecialCharTok{*}\FunctionTok{max}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{pow.obs.norm), }\AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\FloatTok{9.5}\NormalTok{, }\FloatTok{9.0}\NormalTok{), }\AttributeTok{label =}\NormalTok{ temp, }\AttributeTok{parse =}\NormalTok{ T  ) }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Beta distribution and distribution of normalized power production"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-12-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temp1 }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"k == "}\NormalTok{, mle.ws30.weib[}\DecValTok{1}\NormalTok{]) }\CommentTok{\#par.ws30$par[1]}
\NormalTok{temp2 }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"lambda == "}\NormalTok{, mle.ws30.weib[}\DecValTok{2}\NormalTok{]) }\CommentTok{\#par.ws30$par[2]}
\NormalTok{temp }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(temp1, temp2)}

\FunctionTok{ggplot}\NormalTok{(D)}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ ws30, }\AttributeTok{y =}\NormalTok{ ..count..}\SpecialCharTok{/}\FunctionTok{sum}\NormalTok{(..count..)) , }\AttributeTok{colour =} \StringTok{"white"}\NormalTok{, }\AttributeTok{alpha=}\FloatTok{0.6}\NormalTok{, }\AttributeTok{bins =} \DecValTok{30}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dweibull, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{shape =}\NormalTok{ par.ws30}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{scale =}\NormalTok{ par.ws30}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{])) }\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{( }\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{4}\SpecialCharTok{/}\DecValTok{5}\SpecialCharTok{*}\FunctionTok{max}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{ws30), }\AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.09}\NormalTok{,}\FloatTok{0.085}\NormalTok{), }\AttributeTok{label =}\NormalTok{ temp, }\AttributeTok{parse =}\NormalTok{ T  ) }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Weibull distribution and distribution of the wind speed"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-12-5.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temp1 }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"mu =="}\NormalTok{, mle.wd30[}\DecValTok{1}\NormalTok{]) }\CommentTok{\#wrapped.cauc.par$par[1]}
\NormalTok{temp2 }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"rho =="}\NormalTok{, mle.wd30[}\DecValTok{2}\NormalTok{]) }\CommentTok{\#wrapped.cauc.par$par[2]}
\NormalTok{temp }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(temp1, temp2)}

\FunctionTok{ggplot}\NormalTok{(D)}\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ wd30, }\AttributeTok{y =}\NormalTok{ ..density..), }\AttributeTok{colour =} \StringTok{"white"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.6}\NormalTok{, }\AttributeTok{bins =} \DecValTok{20}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,pi}\SpecialCharTok{/}\DecValTok{2}\NormalTok{,pi,}\DecValTok{3}\SpecialCharTok{/}\DecValTok{2}\SpecialCharTok{*}\NormalTok{pi,}\DecValTok{2}\SpecialCharTok{*}\NormalTok{pi)}
\NormalTok{                     , }\AttributeTok{labels =}\FunctionTok{c}\NormalTok{(}\StringTok{"0"}\NormalTok{, }\StringTok{"pi/2"}\NormalTok{, }\StringTok{"pi"}\NormalTok{, }\StringTok{"3/2pi"}\NormalTok{, }\StringTok{"2pi"}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dwrappedcauchy, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{mu =}\NormalTok{ wrapped.cauc.par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{rho =} \FloatTok{0.36}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{( }\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{1}\SpecialCharTok{/}\DecValTok{5}\SpecialCharTok{*}\FunctionTok{max}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{wd30), }\AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.35}\NormalTok{, }\FloatTok{0.325}\NormalTok{), }\AttributeTok{label =} \FunctionTok{c}\NormalTok{(temp1,temp2), }\AttributeTok{parse =}\NormalTok{ T  ) }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Wrapped cauchy distribution and distribution of the wind direction"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-12-6.pdf}

\hypertarget{projekt-2-survival-data}{%
\subsection{Projekt 2: Survival Data}\label{projekt-2-survival-data}}

\hypertarget{analysis-of-the-binary-data}{%
\subsubsection{Analysis of the Binary
Data}\label{analysis-of-the-binary-data}}

\hypertarget{read-the-data-logistic.txt-into-r.}{%
\paragraph{Read the data Logistic.txt into
R.}\label{read-the-data-logistic.txt-into-r.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{log.data }\OtherTok{\textless{}{-}} \FunctionTok{read.table}\NormalTok{(}\StringTok{"Logistic.txt"}\NormalTok{, }\AttributeTok{header=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{sep=}\StringTok{""}\NormalTok{, }
                       \AttributeTok{as.is=}\ConstantTok{TRUE}\NormalTok{)}

\FunctionTok{str}\NormalTok{(log.data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    2 obs. of  3 variables:
##  $ AZT     : chr  "Yes" "No"
##  $ AIDS_yes: int  25 44
##  $ n       : int  170 168
\end{verbatim}

\hypertarget{fit-the-binomial-distribution-to-the-data-i.e.-consider-all-data-as-com-}{%
\paragraph{Fit the Binomial distribution to the data (i.e.~consider all
data as
com-}\label{fit-the-binomial-distribution-to-the-data-i.e.-consider-all-data-as-com-}}

ing from the same population)

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#all data from one population:}
\NormalTok{bin.par }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FloatTok{0.1}\NormalTok{, }\AttributeTok{objective =}\NormalTok{ testDistribution}
\NormalTok{                  , }\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\FunctionTok{sum}\NormalTok{(log.data}\SpecialCharTok{$}\NormalTok{AIDS\_yes), }\FunctionTok{sum}\NormalTok{(log.data}\SpecialCharTok{$}\NormalTok{n))}
\NormalTok{                  , }\AttributeTok{distribution =} \StringTok{"binomial"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{fit-the-binomial-separately-to-the-two-distributions-and-test-if-there-is-a-difference-between-the-groups.}{%
\paragraph{Fit the Binomial separately to the two distributions and test
if there is a difference between the
groups.}\label{fit-the-binomial-separately-to-the-two-distributions-and-test-if-there-is-a-difference-between-the-groups.}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#separately for the groups}
\NormalTok{x.AZT }\OtherTok{\textless{}{-}}\NormalTok{ log.data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(AZT }\SpecialCharTok{==} \StringTok{"Yes"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(AIDS\_yes, n) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{as.numeric}\NormalTok{()}

\NormalTok{AZT.par }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FloatTok{0.1}\NormalTok{, }\AttributeTok{objective =}\NormalTok{ testDistribution}
\NormalTok{                  , }\AttributeTok{x =} \FunctionTok{c}\NormalTok{(x.AZT[}\DecValTok{1}\NormalTok{], x.AZT[}\DecValTok{2}\NormalTok{])}
\NormalTok{                  , }\AttributeTok{distribution =} \StringTok{"binomial"}\NormalTok{)}

\NormalTok{x.no.AZT }\OtherTok{\textless{}{-}}\NormalTok{ log.data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(AZT }\SpecialCharTok{==} \StringTok{"No"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(AIDS\_yes, n) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{as.numeric}\NormalTok{()}

\NormalTok{no.AZT.par }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FloatTok{0.1}\NormalTok{, }\AttributeTok{objective =}\NormalTok{ testDistribution}
\NormalTok{                     , }\AttributeTok{x =} \FunctionTok{c}\NormalTok{(x.no.AZT[}\DecValTok{1}\NormalTok{], x.no.AZT[}\DecValTok{2}\NormalTok{])}
\NormalTok{                     , }\AttributeTok{distribution =} \StringTok{"binomial"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Testing if there's a difference between the two groups:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p.hat }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(log.data}\SpecialCharTok{$}\NormalTok{AIDS\_yes)}\SpecialCharTok{/}\FunctionTok{sum}\NormalTok{(log.data}\SpecialCharTok{$}\NormalTok{n)}\CommentTok{\#bin.par$par}


\CommentTok{\#Calculate expected values for this group based on each group size:}
\NormalTok{e.A.AZT }\OtherTok{\textless{}{-}}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{n[log.data}\SpecialCharTok{$}\NormalTok{AZT }\SpecialCharTok{==} \StringTok{"Yes"}\NormalTok{]}\SpecialCharTok{*}\NormalTok{p.hat}
\NormalTok{e.A.no\_AZT }\OtherTok{\textless{}{-}}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{n[log.data}\SpecialCharTok{$}\NormalTok{AZT }\SpecialCharTok{==} \StringTok{"No"}\NormalTok{]}\SpecialCharTok{*}\NormalTok{p.hat}

\NormalTok{e.nA.AZT }\OtherTok{\textless{}{-}}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{n[log.data}\SpecialCharTok{$}\NormalTok{AZT }\SpecialCharTok{==} \StringTok{"Yes"}\NormalTok{]}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{p.hat)}
\NormalTok{e.nA.no\_AZT }\OtherTok{\textless{}{-}}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{n[log.data}\SpecialCharTok{$}\NormalTok{AZT }\SpecialCharTok{==} \StringTok{"No"}\NormalTok{]}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{p.hat)}

\NormalTok{e }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(e.A.AZT, e.A.no\_AZT, e.nA.AZT, e.nA.no\_AZT)}
\CommentTok{\#by hand}
\NormalTok{chi\_squared }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{((}\FunctionTok{c}\NormalTok{(log.data}\SpecialCharTok{$}\NormalTok{AIDS\_yes,log.data}\SpecialCharTok{$}\NormalTok{n}\SpecialCharTok{{-}}\NormalTok{log.data}\SpecialCharTok{$}\NormalTok{AIDS\_yes)}\SpecialCharTok{{-}}\NormalTok{e)}\SpecialCharTok{\^{}}\DecValTok{2}\SpecialCharTok{/}\NormalTok{e)}
\NormalTok{(chi\_squared)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 6.859695
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#probability of observing this chi{-}squared test statistic given that the null{-}hypothesis is true}
\NormalTok{rows }\OtherTok{\textless{}{-}} \FunctionTok{dim}\NormalTok{(log.data)[}\DecValTok{1}\NormalTok{]}
\NormalTok{columns }\OtherTok{\textless{}{-}} \FunctionTok{dim}\NormalTok{(log.data)[}\DecValTok{2}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1} \CommentTok{\#{-}1 because of the AZT column}
\FunctionTok{pchisq}\NormalTok{(chi\_squared,}\AttributeTok{df=}\NormalTok{(rows}\DecValTok{{-}1}\NormalTok{)}\SpecialCharTok{*}\NormalTok{(columns}\DecValTok{{-}1}\NormalTok{),}\AttributeTok{lower.tail=}\ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.008816159
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#WITH CONTINUITY CORRECTION:}
\CommentTok{\#https://en.wikipedia.org/wiki/Yates\%27s\_correction\_for\_continuity}
\NormalTok{chi\_squared\_yates }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{((}\FunctionTok{abs}\NormalTok{(}\FunctionTok{c}\NormalTok{(log.data}\SpecialCharTok{$}\NormalTok{AIDS\_yes,log.data}\SpecialCharTok{$}\NormalTok{n}\SpecialCharTok{{-}}\NormalTok{log.data}\SpecialCharTok{$}\NormalTok{AIDS\_yes)}\SpecialCharTok{{-}}\NormalTok{e)}\SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{)}\SpecialCharTok{\^{}}\DecValTok{2}\SpecialCharTok{/}\NormalTok{e)}
\NormalTok{(chi\_squared\_yates)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 6.171023
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#probability of observing this chi{-}squared test statistic given that the null{-}hypothesis is true}
\NormalTok{rows }\OtherTok{\textless{}{-}} \FunctionTok{dim}\NormalTok{(log.data)[}\DecValTok{1}\NormalTok{]}
\NormalTok{columns }\OtherTok{\textless{}{-}} \FunctionTok{dim}\NormalTok{(log.data)[}\DecValTok{2}\NormalTok{]}\SpecialCharTok{{-}}\DecValTok{1} \CommentTok{\#{-}1 because of the AZT column}
\FunctionTok{pchisq}\NormalTok{(chi\_squared\_yates,}\AttributeTok{df=}\NormalTok{(rows}\DecValTok{{-}1}\NormalTok{)}\SpecialCharTok{*}\NormalTok{(columns}\DecValTok{{-}1}\NormalTok{),}\AttributeTok{lower.tail=}\ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.01298595
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#direct using R:}
\NormalTok{log.data.for.chi }\OtherTok{\textless{}{-}}\NormalTok{ log.data; log.data.for.chi}\SpecialCharTok{$}\NormalTok{f }\OtherTok{\textless{}{-}}\NormalTok{ log.data.for.chi}\SpecialCharTok{$}\NormalTok{n }\SpecialCharTok{{-}}\NormalTok{ log.data.for.chi}\SpecialCharTok{$}\NormalTok{AIDS\_yes}
\FunctionTok{prop.test}\NormalTok{(log.data}\SpecialCharTok{$}\NormalTok{AIDS\_yes, log.data}\SpecialCharTok{$}\NormalTok{n)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  2-sample test for equality of proportions with continuity correction
## 
## data:  log.data$AIDS_yes out of log.data$n
## X-squared = 6.171, df = 1, p-value = 0.01299
## alternative hypothesis: two.sided
## 95 percent confidence interval:
##  -0.20593715 -0.02375473
## sample estimates:
##    prop 1    prop 2 
## 0.1470588 0.2619048
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#or}
\FunctionTok{chisq.test}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(log.data.for.chi[,}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{)]))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Pearson's Chi-squared test with Yates' continuity correction
## 
## data:  as.matrix(log.data.for.chi[, c(2, 4)])
## X-squared = 6.171, df = 1, p-value = 0.01299
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\# Result: There\textquotesingle{}s a difference between the two groups.}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Mean p for group with AZT treatment: "}\NormalTok{, }\FunctionTok{round}\NormalTok{(AZT.par}\SpecialCharTok{$}\NormalTok{par,}\DecValTok{3}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Mean p for group with AZT treatment: 0.147"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Mean p for group with no AZT treatment: "}\NormalTok{, }\FunctionTok{round}\NormalTok{(no.AZT.par}\SpecialCharTok{$}\NormalTok{par,}\DecValTok{3}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Mean p for group with no AZT treatment: 0.262"
\end{verbatim}

Result: There is a statistically significant effect of the treatment.

\hypertarget{estimate-parameters-in-the-model-p0-probability-of-aids-in-control-group-p1-probability-of-aids-in-treatment-group-and-report-a-confidence-interval-for-the-parameter-describing-the-difference-compare-with-the-result-above.}{%
\paragraph{Estimate parameters in the model (p0 probability of AIDS in
control group, p1 probability of AIDS in treatment group) and report a
confidence interval for the parameter describing the difference, compare
with the result
above.}\label{estimate-parameters-in-the-model-p0-probability-of-aids-in-control-group-p1-probability-of-aids-in-treatment-group-and-report-a-confidence-interval-for-the-parameter-describing-the-difference-compare-with-the-result-above.}}

Here \(p_0\) indicate the risk of developing AIDS in the control group
and \(p_1\) indicate the risk of developing AIDS in the AZT treatment
group.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Estimate parameters in the model and report a confidence interval for the parameter }
\CommentTok{\#describing the difference, compare with the result above.}
\CommentTok{\#p\_0: Probability of aids in control group}
\CommentTok{\#p\_1: Probability of aids in treatment group}

\CommentTok{\#calculate likelihood}
\NormalTok{nll.p\_0 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(beta, }\AttributeTok{x =}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{AIDS\_yes[}\DecValTok{2}\NormalTok{], }\AttributeTok{n =}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{n[}\DecValTok{2}\NormalTok{])\{}
\NormalTok{  p }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(beta)}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\FunctionTok{exp}\NormalTok{(beta))}
\NormalTok{  nll }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{dbinom}\NormalTok{(x, }\AttributeTok{size =}\NormalTok{ n, }\AttributeTok{prob =}\NormalTok{ p, }\AttributeTok{log =}\NormalTok{ T))}
  \FunctionTok{return}\NormalTok{(nll)}
\NormalTok{\}}
\NormalTok{opt.p\_0 }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \DecValTok{1}\NormalTok{, }\AttributeTok{objective =}\NormalTok{ nll.p\_0, }\AttributeTok{x =}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{AIDS\_yes[}\DecValTok{2}\NormalTok{], }\AttributeTok{n =}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{n[}\DecValTok{2}\NormalTok{])}
\NormalTok{beta\_0 }\OtherTok{\textless{}{-}}\NormalTok{ opt.p\_0}\SpecialCharTok{$}\NormalTok{par}

\NormalTok{nll.p\_1 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(beta\_1, beta\_0, }\AttributeTok{x =}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{AIDS\_yes[}\DecValTok{1}\NormalTok{], }\AttributeTok{n =}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{n[}\DecValTok{1}\NormalTok{])\{}
\NormalTok{  p }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(beta\_0}\SpecialCharTok{+}\NormalTok{beta\_1)}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\FunctionTok{exp}\NormalTok{(beta\_0}\SpecialCharTok{+}\NormalTok{beta\_1))}
\NormalTok{  nll }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{dbinom}\NormalTok{(x, }\AttributeTok{size =}\NormalTok{ n, }\AttributeTok{prob =}\NormalTok{ p, }\AttributeTok{log =}\NormalTok{ T))}
\NormalTok{\}}
\NormalTok{opt.p\_1 }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \DecValTok{1}
\NormalTok{                  , }\AttributeTok{objective =}\NormalTok{ nll.p\_1}
\NormalTok{                  , }\AttributeTok{beta\_0 =}\NormalTok{ beta\_0}
\NormalTok{                  , }\AttributeTok{x =}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{AIDS\_yes[}\DecValTok{1}\NormalTok{]}
\NormalTok{                  , }\AttributeTok{n =}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{n[}\DecValTok{1}\NormalTok{])}
\NormalTok{beta\_1 }\OtherTok{\textless{}{-}}\NormalTok{ opt.p\_1}\SpecialCharTok{$}\NormalTok{par}

\NormalTok{(p\_0 }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(beta\_0)}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1} \SpecialCharTok{+} \FunctionTok{exp}\NormalTok{(beta\_0)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.2619047
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(p\_1 }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(beta\_0 }\SpecialCharTok{+}\NormalTok{ beta\_1) }\SpecialCharTok{/}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{+} \FunctionTok{exp}\NormalTok{(beta\_0 }\SpecialCharTok{+}\NormalTok{ beta\_1)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.1470588
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{log.data}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   AZT AIDS_yes   n
## 1 Yes       25 170
## 2  No       44 168
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{logistic }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\StringTok{"AZT"} \OtherTok{=} \FunctionTok{c}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{170}\NormalTok{), }\FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{168}\NormalTok{))}
\NormalTok{                       ,}\StringTok{"AIDS\_yes"} \OtherTok{=} \FunctionTok{c}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{),}\FunctionTok{c}\NormalTok{(}\DecValTok{25}\NormalTok{,}\DecValTok{170{-}25}\NormalTok{)), }\FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{44}\NormalTok{, }\DecValTok{168{-}44}\NormalTok{))))}

\NormalTok{fit.glm }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(AIDS\_yes }\SpecialCharTok{\textasciitilde{}}\NormalTok{ AZT, }\AttributeTok{data =}\NormalTok{ logistic, }\AttributeTok{family =}\NormalTok{ binomial)}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"with glm model: "}\NormalTok{, }\FunctionTok{coef}\NormalTok{(fit.glm)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "with glm model: -1.03609193168383"  "with glm model: -0.721765985868547"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"By hand (according to slide 19 lect 4): "}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "By hand (according to slide 19 lect 4): "
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"beta\_0 = "}\NormalTok{, beta\_0, }\StringTok{", beta\_1 = "}\NormalTok{, beta\_1))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "beta_0 = -1.03609206621491, beta_1 = -0.721765851664904"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(fit.glm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = AIDS_yes ~ AZT, family = binomial, data = logistic)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.7793  -0.7793  -0.5640  -0.5640   1.9580  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(>|z|)    
## (Intercept)  -1.0361     0.1755  -5.904 3.54e-09 ***
## AZT          -0.7218     0.2787  -2.590  0.00961 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 342.12  on 337  degrees of freedom
## Residual deviance: 335.19  on 336  degrees of freedom
## AIC: 339.19
## 
## Number of Fisher Scoring iterations: 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#results show: {-}0.72 logits(?) for developing AIDS when using the treatment}

\CommentTok{\# Confidence interval for the two beta parameters. }
\CommentTok{\#calculate profile likelihoods}
\NormalTok{prof.b0 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(beta0, }\AttributeTok{x =}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{AIDS\_yes[}\DecValTok{2}\NormalTok{], }\AttributeTok{n =}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{n[}\DecValTok{2}\NormalTok{])\{}
\NormalTok{  p }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(beta0)}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\FunctionTok{exp}\NormalTok{(beta0))}
  \FunctionTok{return}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{dbinom}\NormalTok{(x, }\AttributeTok{size =}\NormalTok{ n, }\AttributeTok{prob =}\NormalTok{ p, }\AttributeTok{log =}\NormalTok{ T)))}
\NormalTok{\}}

\NormalTok{prof.b1 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(beta1, beta0, }\AttributeTok{x =}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{AIDS\_yes[}\DecValTok{1}\NormalTok{], }\AttributeTok{n =}\NormalTok{ log.data}\SpecialCharTok{$}\NormalTok{n[}\DecValTok{1}\NormalTok{])\{}
\NormalTok{  p }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(beta0}\SpecialCharTok{+}\NormalTok{beta1)}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\FunctionTok{exp}\NormalTok{(beta0}\SpecialCharTok{+}\NormalTok{beta1))}
  \FunctionTok{return}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{dbinom}\NormalTok{(x, }\AttributeTok{size =}\NormalTok{ n, }\AttributeTok{prob =}\NormalTok{ p, }\AttributeTok{log =}\NormalTok{ T)))}
\NormalTok{\}}
\NormalTok{beta.zero.sims }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{1.5}\NormalTok{,}\SpecialCharTok{{-}}\FloatTok{0.6}\NormalTok{,}\FloatTok{0.01}\NormalTok{)}
\NormalTok{beta.one.sims }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{1.3}\NormalTok{,}\SpecialCharTok{{-}}\FloatTok{0.2}\NormalTok{,}\FloatTok{0.01}\NormalTok{)}
\NormalTok{pL.b0 }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(beta.zero.sims, }\AttributeTok{FUN =}\NormalTok{ prof.b0)}
\NormalTok{pL.b1 }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(beta.one.sims, }\AttributeTok{FUN =}\NormalTok{ prof.b1, }\AttributeTok{beta0 =}\NormalTok{ beta\_0)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(beta.zero.sims}
\NormalTok{     , }\SpecialCharTok{{-}}\NormalTok{(pL.b0}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.b0))}
\NormalTok{     , }\StringTok{"l"}
\NormalTok{     , }\AttributeTok{main =} \FunctionTok{TeX}\NormalTok{(}\StringTok{"Profile log{-}likelihood: $}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{beta\_0$"}\NormalTok{))}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h =} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{, }\AttributeTok{lty =} \StringTok{"dashed"}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(beta.one.sims}
\NormalTok{     , }\SpecialCharTok{{-}}\NormalTok{(pL.b1}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.b1))}
\NormalTok{     , }\StringTok{"l"}
\NormalTok{     , }\AttributeTok{main =} \FunctionTok{TeX}\NormalTok{(}\StringTok{"Profile log{-}likelihood: $}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{beta\_1$"}\NormalTok{))}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h =} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{, }\AttributeTok{lty =} \StringTok{"dashed"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-17-1.pdf}

From these figures it can be concluded that the quadratic approximation
of the CI through use of Fischers information matrix, is a sufficiently
good approximation.

The Wald and likelihood-based confidence intervals for the two
\(\beta_i, i\in (0,1)\) parameters can be seen printed below.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sd\_0 }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{sqrt}\NormalTok{(}\FunctionTok{solve}\NormalTok{(}\FunctionTok{hessian}\NormalTok{(beta\_0, }\AttributeTok{func =}\NormalTok{ nll.p\_0))))}
\NormalTok{sd\_1 }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{sqrt}\NormalTok{(}\FunctionTok{solve}\NormalTok{(}\FunctionTok{hessian}\NormalTok{(beta\_1, }\AttributeTok{func =}\NormalTok{ nll.p\_1, }\AttributeTok{beta\_0 =}\NormalTok{ beta\_0))))}

\CommentTok{\#Wald 95\% CIs and profile{-}likelihoods with approx 95\% CI}
\NormalTok{W.CI}\FloatTok{.0} \OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(beta\_0 }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{)}\SpecialCharTok{*}\FunctionTok{qnorm}\NormalTok{(}\FloatTok{0.975}\NormalTok{)}\SpecialCharTok{*}\NormalTok{sd\_0,}\DecValTok{4}\NormalTok{)}
\NormalTok{W.CI}\FloatTok{.1} \OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(beta\_1 }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{)}\SpecialCharTok{*}\FunctionTok{qnorm}\NormalTok{(}\FloatTok{0.975}\NormalTok{)}\SpecialCharTok{*}\NormalTok{sd\_1,}\DecValTok{4}\NormalTok{)}

\CommentTok{\#Direkte numerisk approksimation:}
\NormalTok{CI}\FloatTok{.0} \OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\FunctionTok{min}\NormalTok{(beta.zero.sims[}\SpecialCharTok{{-}}\NormalTok{(pL.b0}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.b0)) }\SpecialCharTok{\textgreater{}} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{])}
\NormalTok{           ,}\FunctionTok{max}\NormalTok{(beta.zero.sims[}\SpecialCharTok{{-}}\NormalTok{(pL.b0}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.b0)) }\SpecialCharTok{\textgreater{}} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{])), }\DecValTok{4}\NormalTok{)}
\NormalTok{CI}\FloatTok{.1} \OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\FunctionTok{min}\NormalTok{(beta.one.sims[}\SpecialCharTok{{-}}\NormalTok{(pL.b1}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.b1)) }\SpecialCharTok{\textgreater{}} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{])}
\NormalTok{           ,}\FunctionTok{max}\NormalTok{(beta.one.sims[}\SpecialCharTok{{-}}\NormalTok{(pL.b1}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.b1)) }\SpecialCharTok{\textgreater{}} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{])), }\DecValTok{4}\NormalTok{)}

\FunctionTok{cat}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Wald Confidence intervals:"}
\NormalTok{      ,}\FunctionTok{paste}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{beta\_0 = "}\NormalTok{, }\FunctionTok{round}\NormalTok{(beta\_0, }\DecValTok{4}\NormalTok{), }\StringTok{" [95\% CI: "}\NormalTok{, W.CI}\FloatTok{.0}\NormalTok{[}\DecValTok{1}\NormalTok{],}\StringTok{", "}\NormalTok{, W.CI}\FloatTok{.0}\NormalTok{[}\DecValTok{2}\NormalTok{],}\StringTok{"]"}\NormalTok{)}
\NormalTok{      ,}\FunctionTok{paste}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{beta\_0 = "}\NormalTok{, }\FunctionTok{round}\NormalTok{(beta\_1, }\DecValTok{4}\NormalTok{), }\StringTok{" [95\% CI: "}\NormalTok{, W.CI}\FloatTok{.1}\NormalTok{[}\DecValTok{1}\NormalTok{],}\StringTok{", "}\NormalTok{, W.CI}\FloatTok{.1}\NormalTok{[}\DecValTok{2}\NormalTok{],}\StringTok{"]"}\NormalTok{)}
\NormalTok{      ,}\StringTok{"}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{Likelihood{-}based Confidence intervals:"}
\NormalTok{      ,}\FunctionTok{paste0}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{beta\_0 = "}\NormalTok{, }\FunctionTok{round}\NormalTok{(beta\_0, }\DecValTok{4}\NormalTok{), }\StringTok{" [95\% CI: "}\NormalTok{, CI}\FloatTok{.0}\NormalTok{[}\DecValTok{1}\NormalTok{],}\StringTok{", "}\NormalTok{, CI}\FloatTok{.0}\NormalTok{[}\DecValTok{2}\NormalTok{],}\StringTok{"]"}\NormalTok{)}
\NormalTok{      ,}\FunctionTok{paste0}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{beta\_0 = "}\NormalTok{, }\FunctionTok{round}\NormalTok{(beta\_1, }\DecValTok{4}\NormalTok{), }\StringTok{" [95\% CI: "}\NormalTok{, CI}\FloatTok{.1}\NormalTok{[}\DecValTok{1}\NormalTok{],}\StringTok{", "}\NormalTok{, CI}\FloatTok{.1}\NormalTok{[}\DecValTok{2}\NormalTok{],}\StringTok{"]"}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald Confidence intervals: 
## beta_0 =  -1.0361  [95% CI:  -1.38 ,  -0.6922 ] 
## beta_0 =  -0.7218  [95% CI:  -1.1462 ,  -0.2973 ] 
## 
## Likelihood-based Confidence intervals: 
## beta_0 = -1.0361 [95% CI: -1.39, -0.71] 
## beta_0 = -0.7218 [95% CI: -1.16, -0.32]
\end{verbatim}

Comparing these to eachother, we see that the Wald CI is a very good
approximation of the actual CIs. However, when comparing the estimates
from our glm model we see that the \(95\%\) CI for AZT is wider for the
model estimate\ldots{}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{confint}\NormalTok{(fit.glm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                 2.5 %     97.5 %
## (Intercept) -1.390358 -0.7006773
## AZT         -1.279159 -0.1827049
\end{verbatim}

Below can be seen the profile log-likelihoods for the two parameters,
alongside their CIs.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(beta.zero.sims}
\NormalTok{     , }\SpecialCharTok{{-}}\NormalTok{(pL.b0}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.b0))}
\NormalTok{     , }\StringTok{"l"}
\NormalTok{     ,}\AttributeTok{main =} \FunctionTok{TeX}\NormalTok{(}\StringTok{"Profile log{-}likelihood: $}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{beta\_0$"}\NormalTok{)}
\NormalTok{     ,}\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(beta[}\DecValTok{0}\NormalTok{])}
\NormalTok{     ,}\AttributeTok{ylab =} \StringTok{"lp {-} max(lp)"}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h =} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =} \FunctionTok{c}\NormalTok{(W.CI}\FloatTok{.0}\NormalTok{), }\AttributeTok{col =} \DecValTok{6}\NormalTok{)}
\FunctionTok{text}\NormalTok{(}\AttributeTok{x =}\NormalTok{ W.CI}\FloatTok{.0}\NormalTok{[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{+}\FloatTok{0.2}\NormalTok{, }\AttributeTok{y =} \SpecialCharTok{{-}}\DecValTok{3}\NormalTok{, }\StringTok{"Wald CI"}\NormalTok{, }\AttributeTok{col =} \DecValTok{6}\NormalTok{)}
\FunctionTok{text}\NormalTok{(}\AttributeTok{x =}\NormalTok{ CI}\FloatTok{.0}\NormalTok{[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{+}\FloatTok{0.1}\NormalTok{, }\AttributeTok{y =} \SpecialCharTok{{-}}\FloatTok{2.5}\NormalTok{, }\StringTok{"CI"}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =} \FunctionTok{c}\NormalTok{(CI}\FloatTok{.0}\NormalTok{), }\AttributeTok{lty =} \StringTok{"dashed"}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(beta.one.sims}
\NormalTok{     , }\SpecialCharTok{{-}}\NormalTok{(pL.b1}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.b1))}
\NormalTok{     , }\StringTok{"l"}
\NormalTok{     ,}\AttributeTok{main =} \FunctionTok{TeX}\NormalTok{(}\StringTok{"Profile log{-}likelihood: $}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{beta\_1$"}\NormalTok{)}
\NormalTok{     ,}\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(beta[}\DecValTok{1}\NormalTok{])}
\NormalTok{     ,}\AttributeTok{ylab =} \StringTok{"lp {-} max(lp)"}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h =} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =} \FunctionTok{c}\NormalTok{(W.CI}\FloatTok{.1}\NormalTok{), }\AttributeTok{col =} \DecValTok{6}\NormalTok{)}
\FunctionTok{text}\NormalTok{(}\AttributeTok{x =}\NormalTok{ W.CI}\FloatTok{.1}\NormalTok{[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{+}\FloatTok{0.2}\NormalTok{, }\AttributeTok{y =} \SpecialCharTok{{-}}\DecValTok{3}\NormalTok{, }\StringTok{"Wald CI"}\NormalTok{, }\AttributeTok{col =} \DecValTok{6}\NormalTok{)}
\FunctionTok{text}\NormalTok{(}\AttributeTok{x =}\NormalTok{ CI}\FloatTok{.1}\NormalTok{[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{+}\FloatTok{0.1}\NormalTok{, }\AttributeTok{y =} \SpecialCharTok{{-}}\FloatTok{2.5}\NormalTok{, }\StringTok{"CI"}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =} \FunctionTok{c}\NormalTok{(CI}\FloatTok{.1}\NormalTok{),}\AttributeTok{lty =} \StringTok{"dashed"}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-20-1.pdf}

\hypertarget{analysis-of-the-survival-time-data}{%
\subsubsection{Analysis of the Survival Time
Data}\label{analysis-of-the-survival-time-data}}

\hypertarget{read-the-data-actg320.txt-into-r.-if-you-are-using-rstudio-you-can-use-the-import-dataset-button.}{%
\paragraph{Read the data actg320.txt into R. If you are using RStudio
you can use the ``Import Dataset''
button.}\label{read-the-data-actg320.txt-into-r.-if-you-are-using-rstudio-you-can-use-the-import-dataset-button.}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#tx: Treatment indicator. 1 = New treatment, 0 = Control treatment}
\CommentTok{\#event: Indicator for AIDS or death. 1 = AIDS diagnosis or death, 0 = Otherwise}
\CommentTok{\#time: Time to AIDS diagnosis or death. Days}
\CommentTok{\#så tiden for event = 0 må angive at personen har været med i studiet time[X] dage uden at være enten død eller fået AIDS.}
\NormalTok{actg320 }\OtherTok{\textless{}{-}} \FunctionTok{read.table}\NormalTok{(}\StringTok{"actg320.txt"}\NormalTok{, }\AttributeTok{header=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{sep=}\StringTok{""}\NormalTok{, }
                      \AttributeTok{as.is=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\#select time, event and tx as they are the only relevant variables in this project}
\NormalTok{actg }\OtherTok{\textless{}{-}}\NormalTok{ actg320 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(time, event, tx)}
\end{Highlighting}
\end{Shaded}

\hypertarget{how-many-patients-got-aids-or-died-in-the-two-treatment-groups-what-is-the-proportion-of-patients-that-got-aids-or-died-in-the-two-group-other-relevant-number-that-could-be-calculated}{%
\paragraph{How many patients got AIDS or died in the two treatment
groups? What is the proportion of patients that got AIDS or died in the
two group? Other relevant number that could be
calculated?}\label{how-many-patients-got-aids-or-died-in-the-two-treatment-groups-what-is-the-proportion-of-patients-that-got-aids-or-died-in-the-two-group-other-relevant-number-that-could-be-calculated}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{actg }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(tx) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\StringTok{"Got AIDS or DIED"} \OtherTok{=} \FunctionTok{sum}\NormalTok{(event),}
            \StringTok{"Proportion"} \OtherTok{=} \FunctionTok{sum}\NormalTok{(event)}\SpecialCharTok{/}\FunctionTok{n}\NormalTok{(),}
            \StringTok{"Participants Given the Treatment"} \OtherTok{=} \FunctionTok{n}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 2 x 4
##      tx `Got AIDS or DIED` Proportion `Participants Given the Treatment`
##   <int>              <int>      <dbl>                              <int>
## 1     0                 63     0.109                                 577
## 2     1                 33     0.0575                                574
\end{verbatim}

\hypertarget{fit-an-exponential-distribution-using-numerical-methods-to-the-time-of-event-time-in-the-data-set-remember-to-take-into-account-that-some-of-the-data-is-censored-i.e.-we-only-know-that-the-time-to-the-event-is-longer-that-the-reported-time.-1-using-all-data-i.e.-ignore-the-treatment-effect-2-separately-for-the-two-treatments}{%
\paragraph{Fit an exponential distribution, using numerical methods, to
the time of event (time) in the data set, remember to take into account
that some of the data is censored (i.e.~we only know that the time to
the event is longer that the reported time). 1: Using all data
(i.e.~ignore the treatment effect) 2: Separately for the two
treatments}\label{fit-an-exponential-distribution-using-numerical-methods-to-the-time-of-event-time-in-the-data-set-remember-to-take-into-account-that-some-of-the-data-is-censored-i.e.-we-only-know-that-the-time-to-the-event-is-longer-that-the-reported-time.-1-using-all-data-i.e.-ignore-the-treatment-effect-2-separately-for-the-two-treatments}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Fitting an exponential model to time for both and for each treatment}
\CommentTok{\#only use times for event = 1, to filter out all the time of event indices with are longer than the reported time}
\CommentTok{\#given the fact that the participants in the event = 0 group, has not \textquotesingle{}experienced\textquotesingle{} the event yet.}
\CommentTok{\#Ved sgu ikke om ovenstående er en passende antagelse....}

\NormalTok{actg\_event }\OtherTok{\textless{}{-}}\NormalTok{ actg }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(event }\SpecialCharTok{==} \DecValTok{1}\NormalTok{)}

\NormalTok{both }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \DecValTok{2}
\NormalTok{               , }\AttributeTok{objective =}\NormalTok{ testDistribution}
\NormalTok{               , }\AttributeTok{x =}\NormalTok{ actg\_event}\SpecialCharTok{$}\NormalTok{time}
\NormalTok{               , }\AttributeTok{distribution =} \StringTok{"exponential"}\NormalTok{)}

\CommentTok{\#separate exponential models}
\NormalTok{t1 }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \DecValTok{2}
\NormalTok{             , }\AttributeTok{objective =}\NormalTok{ testDistribution}
\NormalTok{             , }\AttributeTok{x =} \FunctionTok{filter}\NormalTok{(actg\_event, tx }\SpecialCharTok{==} \DecValTok{1}\NormalTok{)}\SpecialCharTok{$}\NormalTok{time}
\NormalTok{             , }\AttributeTok{distribution =} \StringTok{"exponential"}\NormalTok{)}

\NormalTok{t0 }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \DecValTok{2}
\NormalTok{             , }\AttributeTok{objective =}\NormalTok{ testDistribution}
\NormalTok{             , }\AttributeTok{x =} \FunctionTok{filter}\NormalTok{(actg\_event, tx }\SpecialCharTok{==} \DecValTok{0}\NormalTok{)}\SpecialCharTok{$}\NormalTok{time}
\NormalTok{             , }\AttributeTok{distribution =} \StringTok{"exponential"}\NormalTok{)}
\CommentTok{\#Potato plots:}
\NormalTok{p.both }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(actg\_event)}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ time, }\AttributeTok{y =}\NormalTok{ ..density.., }\AttributeTok{fill =} \StringTok{"Data"}\NormalTok{), }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{colour =} \StringTok{"Exp. Model"}\NormalTok{), }\AttributeTok{fun =}\NormalTok{ dexp, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(actg\_event)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{rate =}\NormalTok{ both}\SpecialCharTok{$}\NormalTok{par))}\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Ignoring Treatment Effect"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"top"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{lims}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FunctionTok{max}\NormalTok{(actg\_event}\SpecialCharTok{$}\NormalTok{time)}\SpecialCharTok{+}\DecValTok{10}\NormalTok{), }\AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.012}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{fill =} \StringTok{""}\NormalTok{, }\AttributeTok{colour =} \StringTok{""}\NormalTok{, }\AttributeTok{x =} \StringTok{"Time to Event"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{scale\_colour\_manual}\NormalTok{(}\AttributeTok{values =} \StringTok{"purple"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \StringTok{"purple"}\NormalTok{)}

\NormalTok{p.t1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(actg\_event[actg\_event}\SpecialCharTok{$}\NormalTok{tx }\SpecialCharTok{==} \DecValTok{1}\NormalTok{,])}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ time, }\AttributeTok{y =}\NormalTok{ ..density.., }\AttributeTok{fill =} \StringTok{"Data"}\NormalTok{), }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{colour =} \StringTok{"Exp. Model"}\NormalTok{), }\AttributeTok{fun =}\NormalTok{ dexp, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(actg\_event)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{rate =}\NormalTok{ t1}\SpecialCharTok{$}\NormalTok{par))}\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Treatment"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"top"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{lims}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FunctionTok{max}\NormalTok{(actg\_event}\SpecialCharTok{$}\NormalTok{time)}\SpecialCharTok{+}\DecValTok{10}\NormalTok{), }\AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.012}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{fill =} \StringTok{""}\NormalTok{, }\AttributeTok{colour =} \StringTok{""}\NormalTok{, }\AttributeTok{x =} \StringTok{"Time to Event"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{scale\_colour\_manual}\NormalTok{(}\AttributeTok{values =} \StringTok{"blue"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \StringTok{"blue"}\NormalTok{)}

\NormalTok{p.t2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(actg\_event[actg\_event}\SpecialCharTok{$}\NormalTok{tx }\SpecialCharTok{==} \DecValTok{0}\NormalTok{,])}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ time, }\AttributeTok{y =}\NormalTok{ ..density.., }\AttributeTok{fill =} \StringTok{"Data"}\NormalTok{), }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{colour =} \StringTok{"Exp. Model"}\NormalTok{), }\AttributeTok{fun =}\NormalTok{ dexp, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(actg\_event)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{rate =}\NormalTok{ t0}\SpecialCharTok{$}\NormalTok{par))}\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"No Treatment"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"top"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{lims}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FunctionTok{max}\NormalTok{(actg\_event}\SpecialCharTok{$}\NormalTok{time)}\SpecialCharTok{+}\DecValTok{10}\NormalTok{), }\AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.012}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{scale\_colour\_manual}\NormalTok{(}\AttributeTok{values =} \StringTok{"red"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{fill =} \StringTok{""}\NormalTok{, }\AttributeTok{colour =} \StringTok{""}\NormalTok{, }\AttributeTok{x =} \StringTok{"Time to Event"}\NormalTok{)}\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \StringTok{"red"}\NormalTok{)}

\FunctionTok{grid.arrange}\NormalTok{(p.both, p.t1, p.t2, }\AttributeTok{nrow =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-23-1.pdf}

\hypertarget{compared-the-likelihood-for-the-above-models-and-conclude}{%
\paragraph{Compared the likelihood for the above models and
conclude}\label{compared-the-likelihood-for-the-above-models-and-conclude}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Likelihood Ratio Test (LRT) comparison}
\CommentTok{\#one model:}
\NormalTok{chi\_squared }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}} \DecValTok{2} \SpecialCharTok{*}\NormalTok{ ((t1}\SpecialCharTok{$}\NormalTok{objective }\SpecialCharTok{+}\NormalTok{ t0}\SpecialCharTok{$}\NormalTok{objective) }\SpecialCharTok{{-}}\NormalTok{ both}\SpecialCharTok{$}\NormalTok{objective)}
\NormalTok{(p\_value }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{{-}} \FunctionTok{pchisq}\NormalTok{(chi\_squared, }\AttributeTok{df =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.4697636
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#no difference as p\_value: 0.46 \textgreater{} 0.05.}
\end{Highlighting}
\end{Shaded}

From the above calculation of the p-value = \texttt{\{r\}\ p\_value}, we
see that there's - according to this model - no significant difference
is achieved by using the treatment. However, this model is flawed, as it
does not account for all the censored datapoints. This will be addressed
in the coming analysis, where we use the kaplan meier survival analysis.

Below can be seen a QQ-plot of the model, which also clearly shows that
the model is unable to capture the underlying distribution of the data.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{theoretical }\OtherTok{\textless{}{-}} \FunctionTok{quantile}\NormalTok{(}\AttributeTok{x =}\NormalTok{ actg\_event}\SpecialCharTok{$}\NormalTok{time, }\AttributeTok{probs =} \FunctionTok{pexp}\NormalTok{(}\AttributeTok{q =}\NormalTok{ actg\_event}\SpecialCharTok{$}\NormalTok{time, }\AttributeTok{rate =}\NormalTok{ both}\SpecialCharTok{$}\NormalTok{par))}
\FunctionTok{plot}\NormalTok{(theoretical, actg\_event}\SpecialCharTok{$}\NormalTok{time, }\AttributeTok{main =} \StringTok{"QQplot"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Theoretical Quantiles"}
\NormalTok{     ,}\AttributeTok{ylab =} \StringTok{"Sample Quantiles"}\NormalTok{)}
\FunctionTok{grid}\NormalTok{()}
\FunctionTok{abline}\NormalTok{(}\FunctionTok{lm}\NormalTok{(actg\_event}\SpecialCharTok{$}\NormalTok{time }\SpecialCharTok{\textasciitilde{}}\NormalTok{ theoretical))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-25-1.pdf}

\hypertarget{formulate-a-model-where-one-parameter-indicate-the-treatment-effect-find-the-mle-and-compare-with-the-result-above.}{%
\paragraph{Formulate a model where one parameter indicate the treatment
effect, find the MLE and compare with the result
above.}\label{formulate-a-model-where-one-parameter-indicate-the-treatment-effect-find-the-mle-and-compare-with-the-result-above.}}

(e.g.~E{[}T{]} = \(e^\beta_0\) if control group and E{[}T{]} =
\(e^{\beta_0 + \beta_1}\) if treatment group)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{kaplan.meier }\OtherTok{\textless{}{-}} \FunctionTok{survfit}\NormalTok{(}\FunctionTok{Surv}\NormalTok{(time, event) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ tx, }\AttributeTok{data =}\NormalTok{ actg)}
\FunctionTok{ggsurvplot\_add\_all}\NormalTok{(kaplan.meier}
\NormalTok{                   , }\AttributeTok{data =}\NormalTok{ actg}
\NormalTok{                   , }\AttributeTok{conf.int =}\NormalTok{ T}
\NormalTok{                   , }\AttributeTok{risk.table =} \StringTok{"abs\_pct"}
\NormalTok{                   , }\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.8}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{                   , }\AttributeTok{pval =}\NormalTok{ T}
\NormalTok{                   , }\AttributeTok{ncensor.plot =}\NormalTok{ T}
\NormalTok{                   ,}\AttributeTok{ggtheme =} \FunctionTok{theme\_bw}\NormalTok{()}
\NormalTok{                   ,}\AttributeTok{legend.labs =} \FunctionTok{c}\NormalTok{(}\StringTok{"All"}\NormalTok{, }\StringTok{"No Treatment"}\NormalTok{, }\StringTok{"Treatment"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-26-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit }\OtherTok{\textless{}{-}} \FunctionTok{survreg}\NormalTok{(}\FunctionTok{Surv}\NormalTok{(time, event) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ tx, }\AttributeTok{data =}\NormalTok{ actg,}
               \AttributeTok{dist =} \StringTok{"exponential"}\NormalTok{)}
\FunctionTok{summary}\NormalTok{(fit)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## survreg(formula = Surv(time, event) ~ tx, data = actg, dist = "exponential")
##             Value Std. Error     z      p
## (Intercept) 7.624      0.126 60.52 <2e-16
## tx          0.699      0.215  3.25 0.0011
## 
## Scale fixed at 1 
## 
## Exponential distribution
## Loglik(model)= -851   Loglik(intercept only)= -856.6
##  Chisq= 11.18 on 1 degrees of freedom, p= 0.00083 
## Number of Newton-Raphson Iterations: 6 
## n= 1151
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{confint}\NormalTok{(fit)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                 2.5 %   97.5 %
## (Intercept) 7.3774309 7.871295
## tx          0.2780026 1.120341
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Overvej residual plot}

\CommentTok{\#Ifølge ovenstående:}
\CommentTok{\#beta0 = 7.62 95\% CI [7.38; 7.87]}
\CommentTok{\#beta1 = 0.699 85\% CI [0.28; 1.12]}
\CommentTok{\# =\textgreater{} Significant difference.}

\CommentTok{\#ifølge ovenstående er der statistisk signifikant forskel. Herunder regnes i hånden i stedet, så}
\CommentTok{\#vi ved hvad der foregår.}
\end{Highlighting}
\end{Shaded}

Are the effect of the treatment statistically significant?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{surv\_diff }\OtherTok{\textless{}{-}} \FunctionTok{survdiff}\NormalTok{(}\FunctionTok{Surv}\NormalTok{(time, event) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ tx, }\AttributeTok{data =}\NormalTok{ actg)}
\NormalTok{surv\_diff}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Call:
## survdiff(formula = Surv(time, event) ~ tx, data = actg)
## 
##        N Observed Expected (O-E)^2/E (O-E)^2/V
## tx=0 577       63     47.1      5.37      10.5
## tx=1 574       33     48.9      5.17      10.5
## 
##  Chisq= 10.5  on 1 degrees of freedom, p= 0.001
\end{verbatim}

Yes it is.

Same calculations but now performed by hand:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#I hånden (jvf. slides fra uge 7):}
\CommentTok{\#model: T = exp(B0 + B1*tx)*epsilon, epsilon \textasciitilde{} exp(1)}
\CommentTok{\#Der kan opstilles to forskellige modeller afhængigt af tx = 0 eller tx = 1.}
\CommentTok{\#tx = 0: E[T] = exp(b0)*epsilon}
\CommentTok{\#tx = 1: E[T] = exp(b0 + b1)*epsilon}

\CommentTok{\#Likelihood}
\NormalTok{nll.exp }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(beta, }\AttributeTok{time =}\NormalTok{ actg}\SpecialCharTok{$}\NormalTok{time, }\AttributeTok{event =}\NormalTok{ actg}\SpecialCharTok{$}\NormalTok{event, }\AttributeTok{treatment =}\NormalTok{ actg}\SpecialCharTok{$}\NormalTok{tx)\{}
\NormalTok{  beta0 }\OtherTok{\textless{}{-}}\NormalTok{ beta[}\DecValTok{1}\NormalTok{]}
  \CommentTok{\#dont want to make two functions so let beta1 = 0 if no treatment is not considered/used:}
  \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{max}\NormalTok{(treatment) }\SpecialCharTok{==} \DecValTok{0}\NormalTok{)\{}
\NormalTok{    beta1 }\OtherTok{\textless{}{-}} \DecValTok{0}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    beta1 }\OtherTok{\textless{}{-}}\NormalTok{ beta[}\DecValTok{2}\NormalTok{]}
\NormalTok{  \}}
  
\NormalTok{  h }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{ beta0 }\SpecialCharTok{{-}}\NormalTok{ beta1 }\SpecialCharTok{*}\NormalTok{ treatment)}
\NormalTok{  H }\OtherTok{\textless{}{-}}\NormalTok{ time}\SpecialCharTok{/}\FunctionTok{exp}\NormalTok{(beta0 }\SpecialCharTok{+}\NormalTok{ beta1}\SpecialCharTok{*}\NormalTok{treatment)}
\NormalTok{  nll }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(event}\SpecialCharTok{*}\FunctionTok{log}\NormalTok{(h) }\SpecialCharTok{{-}}\NormalTok{ H)}
  \FunctionTok{return}\NormalTok{(nll)}
\NormalTok{\}}

\NormalTok{beta\_hat }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{                   , }\AttributeTok{objective =}\NormalTok{ nll.exp}
\NormalTok{                   , }\AttributeTok{time =}\NormalTok{ actg}\SpecialCharTok{$}\NormalTok{time}
\NormalTok{                   , }\AttributeTok{event =}\NormalTok{ actg}\SpecialCharTok{$}\NormalTok{event}
\NormalTok{                   , }\AttributeTok{treatment =}\NormalTok{ actg}\SpecialCharTok{$}\NormalTok{tx)}
\NormalTok{beta\_hat}\SpecialCharTok{$}\NormalTok{par}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 7.6243647 0.6991732
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Comparing likelihoods with the result from bullet{-}point 4}
\NormalTok{beta\_hat}\SpecialCharTok{$}\NormalTok{objective }\CommentTok{\#Ved ikke lige om der skal sammenlignes med de to modeller eller den ene? ahh}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 851.0115
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#måske skal man undersøge om begge værdier er statistisk signifikante således at vi kan argumentere for}
\CommentTok{\#at der er tale om at behandlingen virker og sammenligne dette resultat med bullet{-}point 4.}

\CommentTok{\#Calculate LRT}
\CommentTok{\#optimise model without beta1 (no treatment):}
\NormalTok{beta\_no\_treatment\_effect }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \DecValTok{1}
\NormalTok{                                   , }\AttributeTok{objective =}\NormalTok{ nll.exp}
\NormalTok{                                   , }\AttributeTok{time =}\NormalTok{ actg}\SpecialCharTok{$}\NormalTok{time}
\NormalTok{                                   , }\AttributeTok{event =}\NormalTok{ actg}\SpecialCharTok{$}\NormalTok{event}
\NormalTok{                                   , }\AttributeTok{treatment =} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{length}\NormalTok{(actg}\SpecialCharTok{$}\NormalTok{tx)))}

\NormalTok{beta\_no\_treatment\_effect}\SpecialCharTok{$}\NormalTok{par}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 7.922914
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#LRT:}
\NormalTok{chi\_squared }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}} \DecValTok{2} \SpecialCharTok{*}\NormalTok{ (beta\_hat}\SpecialCharTok{$}\NormalTok{objective }\SpecialCharTok{{-}}\NormalTok{ beta\_no\_treatment\_effect}\SpecialCharTok{$}\NormalTok{objective)}
\NormalTok{(p\_value }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{{-}} \FunctionTok{pchisq}\NormalTok{(chi\_squared, }\AttributeTok{df =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.0008284118
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Here, we see that the treatment effect is statistically significant.}

\DocumentationTok{\#\#\#\# Bullet point 6 {-} Wald CI for the treatment parameters beta0 and beta1 \#\#\#\#}
\CommentTok{\#Calculate profile likelihoods to ensure that the quadratic approximation by using Fischers Information matrix}
\CommentTok{\#is acceptable.}

\NormalTok{beta.zero.sims }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\FloatTok{7.3}\NormalTok{,}\FloatTok{7.9}\NormalTok{,}\FloatTok{0.01}\NormalTok{)}
\NormalTok{beta.one.sims }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\FloatTok{0.2}\NormalTok{,}\FloatTok{1.2}\NormalTok{,}\FloatTok{0.01}\NormalTok{)}
\NormalTok{pL.beta0 }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(}\AttributeTok{X =} \FunctionTok{data.frame}\NormalTok{(beta.zero.sims,beta\_hat}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]), }\AttributeTok{MARGIN =} \DecValTok{1}\NormalTok{ , }\AttributeTok{FUN =}\NormalTok{ nll.exp, }\AttributeTok{time =}\NormalTok{ actg}\SpecialCharTok{$}\NormalTok{time, }\AttributeTok{event =}\NormalTok{ actg}\SpecialCharTok{$}\NormalTok{event, }\AttributeTok{treatment =}\NormalTok{ actg}\SpecialCharTok{$}\NormalTok{tx)}
\NormalTok{pL.beta1 }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(}\AttributeTok{X =} \FunctionTok{data.frame}\NormalTok{(beta\_hat}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{],beta.one.sims), }\AttributeTok{MARGIN =} \DecValTok{1}\NormalTok{ , }\AttributeTok{FUN =}\NormalTok{ nll.exp, }\AttributeTok{time =}\NormalTok{ actg}\SpecialCharTok{$}\NormalTok{time, }\AttributeTok{event =}\NormalTok{ actg}\SpecialCharTok{$}\NormalTok{event, }\AttributeTok{treatment =}\NormalTok{ actg}\SpecialCharTok{$}\NormalTok{tx)}

\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(beta.zero.sims}
\NormalTok{     , }\SpecialCharTok{{-}}\NormalTok{(pL.beta0}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.beta0))}
\NormalTok{     , }\StringTok{"l"}
\NormalTok{     ,}\AttributeTok{main =} \StringTok{"Profile likelihood for Beta 0"}
\NormalTok{     ,}\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(beta[}\DecValTok{0}\NormalTok{])}
\NormalTok{     ,}\AttributeTok{ylab =} \StringTok{"lp {-} max(lp)"}
\NormalTok{     ,}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{3.2}\NormalTok{,}\DecValTok{0}\NormalTok{))}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h =} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(beta.one.sims}
\NormalTok{     , }\SpecialCharTok{{-}}\NormalTok{(pL.beta1}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.beta1))}
\NormalTok{     , }\StringTok{"l"}
\NormalTok{     ,}\AttributeTok{main =} \StringTok{"Profile likelihood for beta 1"}
\NormalTok{     ,}\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(beta[}\DecValTok{1}\NormalTok{])}
\NormalTok{     ,}\AttributeTok{ylab =} \StringTok{"lp {-} max(lp)"}
\NormalTok{     ,}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{3.2}\NormalTok{,}\DecValTok{0}\NormalTok{))}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h =} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-28-1.pdf}

\hypertarget{find-the-wald-confidence-interval-for-the-treatment-parameter-in-the-model-above.}{%
\paragraph{Find the Wald confidence interval for the treatment parameter
in the model
above.}\label{find-the-wald-confidence-interval-for-the-treatment-parameter-in-the-model-above.}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#CI:}
\NormalTok{sd }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{sqrt}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{solve}\NormalTok{(}\FunctionTok{hessian}\NormalTok{(beta\_hat}\SpecialCharTok{$}\NormalTok{par, }\AttributeTok{func =}\NormalTok{ nll.exp)))))}

\CommentTok{\#Wald 95 procent CIs and profile{-}likelihoods with approx 95 procent CI}
\CommentTok{\#Måske er der et eller andet i vejen med de her WALD CIs}
\NormalTok{Wald.CI }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(beta\_hat}\SpecialCharTok{$}\NormalTok{par }\SpecialCharTok{+} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{, }\AttributeTok{byrow =}\NormalTok{ T) }\SpecialCharTok{*} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{qnorm}\NormalTok{(}\FloatTok{0.975}\NormalTok{)}\SpecialCharTok{*}\NormalTok{sd, }\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{, }\AttributeTok{byrow =}\NormalTok{ F),}\DecValTok{4}\NormalTok{)}

\CommentTok{\#Direkte numerisk approksimation:}
\NormalTok{CI}\FloatTok{.0} \OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{min}\NormalTok{(beta.zero.sims[}\SpecialCharTok{{-}}\NormalTok{(pL.beta0}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.beta0)) }\SpecialCharTok{\textgreater{}} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{])}
\NormalTok{           ,}\FunctionTok{max}\NormalTok{(beta.zero.sims[}\SpecialCharTok{{-}}\NormalTok{(pL.beta0}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.beta0)) }\SpecialCharTok{\textgreater{}} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{]))}
\NormalTok{CI}\FloatTok{.1} \OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{min}\NormalTok{(beta.one.sims[}\SpecialCharTok{{-}}\NormalTok{(pL.beta1}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.beta1)) }\SpecialCharTok{\textgreater{}} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{])}
\NormalTok{           ,}\FunctionTok{max}\NormalTok{(beta.one.sims[}\SpecialCharTok{{-}}\NormalTok{(pL.beta1}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.beta1)) }\SpecialCharTok{\textgreater{}} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{]))}

\FunctionTok{cat}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Wald Confidence intervals:"}
\NormalTok{      ,}\FunctionTok{paste}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{beta\_0 = "}\NormalTok{, }\FunctionTok{round}\NormalTok{(beta\_hat}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\DecValTok{4}\NormalTok{), }\StringTok{" [95\% CI: "}\NormalTok{, Wald.CI[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{],}\StringTok{", "}\NormalTok{, Wald.CI[}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{],}\StringTok{"]"}\NormalTok{)}
\NormalTok{      ,}\FunctionTok{paste}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{beta\_1 = "}\NormalTok{, }\FunctionTok{round}\NormalTok{(beta\_hat}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{], }\DecValTok{4}\NormalTok{), }\StringTok{" [95\% CI: "}\NormalTok{, Wald.CI[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{],}\StringTok{", "}\NormalTok{, Wald.CI[}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{],}\StringTok{"]"}\NormalTok{)}
\NormalTok{      ,}\StringTok{"}\SpecialCharTok{\textbackslash{}n\textbackslash{}n}\StringTok{Likelihood{-}based Confidence intervals:"}
\NormalTok{      ,}\FunctionTok{paste0}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{beta\_0 = "}\NormalTok{, }\FunctionTok{round}\NormalTok{(beta\_hat}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\DecValTok{4}\NormalTok{), }\StringTok{" [95\% CI: "}\NormalTok{, CI}\FloatTok{.0}\NormalTok{[}\DecValTok{1}\NormalTok{],}\StringTok{", "}\NormalTok{, CI}\FloatTok{.0}\NormalTok{[}\DecValTok{2}\NormalTok{],}\StringTok{"]"}\NormalTok{)}
\NormalTok{      ,}\FunctionTok{paste0}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{beta\_1 = "}\NormalTok{, }\FunctionTok{round}\NormalTok{(beta\_hat}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{], }\DecValTok{4}\NormalTok{), }\StringTok{" [95\% CI: "}\NormalTok{, CI}\FloatTok{.1}\NormalTok{[}\DecValTok{1}\NormalTok{],}\StringTok{", "}\NormalTok{, CI}\FloatTok{.1}\NormalTok{[}\DecValTok{2}\NormalTok{],}\StringTok{"]"}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Wald Confidence intervals: 
## beta_0 =  7.6244  [95% CI:  7.3774 ,  7.8713 ] 
## beta_1 =  0.6992  [95% CI:  0.278 ,  1.1203 ] 
## 
## Likelihood-based Confidence intervals: 
## beta_0 = 7.6244 [95% CI: 7.44, 7.83] 
## beta_1 = 0.6992 [95% CI: 0.38, 1.06]
\end{verbatim}

Comparing with the results from the survfit function:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{confint}\NormalTok{(fit)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                 2.5 %   97.5 %
## (Intercept) 7.3774309 7.871295
## tx          0.2780026 1.120341
\end{verbatim}

Same as the wald CI. The likelihood based CI is a bit more narrow.

\hypertarget{derive-the-theoretical-results-for-the-models-above-including-the-standard-error-estimates-use-this-to-formulate-and-implement-the-profile-likelihood-function-for-the-treatment-parameter}{%
\paragraph{Derive the theoretical results for the models above,
including the standard error estimates, use this to formulate and
implement the profile likelihood function for the treatment
parameter}\label{derive-the-theoretical-results-for-the-models-above-including-the-standard-error-estimates-use-this-to-formulate-and-implement-the-profile-likelihood-function-for-the-treatment-parameter}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(beta.zero.sims}
\NormalTok{     , }\SpecialCharTok{{-}}\NormalTok{(pL.beta0}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.beta0))}
\NormalTok{     , }\StringTok{"l"}
\NormalTok{     ,}\AttributeTok{main =} \StringTok{"Profile likelihood for Beta 0"}
\NormalTok{     ,}\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(beta[}\DecValTok{0}\NormalTok{])}
\NormalTok{     ,}\AttributeTok{ylab =} \StringTok{"lp {-} max(lp)"}
\NormalTok{     ,}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{3.2}\NormalTok{,}\DecValTok{0}\NormalTok{))}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h =} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =}\NormalTok{ Wald.CI[}\DecValTok{1}\NormalTok{,], }\AttributeTok{col =} \DecValTok{6}\NormalTok{)}
\FunctionTok{text}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Wald.CI[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{+}\NormalTok{.}\DecValTok{15}\NormalTok{, }\AttributeTok{y =} \SpecialCharTok{{-}}\FloatTok{2.4}\NormalTok{, }\StringTok{"Wald CI"}\NormalTok{, }\AttributeTok{col =} \DecValTok{6}\NormalTok{)}
\FunctionTok{text}\NormalTok{(}\AttributeTok{x =}\NormalTok{ CI}\FloatTok{.0}\NormalTok{[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{+}\NormalTok{.}\DecValTok{05}\NormalTok{, }\AttributeTok{y =} \SpecialCharTok{{-}}\FloatTok{2.5}\NormalTok{, }\StringTok{"CI"}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =} \FunctionTok{c}\NormalTok{(CI}\FloatTok{.0}\NormalTok{), }\AttributeTok{lty =} \StringTok{"dashed"}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(beta.one.sims}
\NormalTok{     , }\SpecialCharTok{{-}}\NormalTok{(pL.beta1}\SpecialCharTok{+}\FunctionTok{max}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{pL.beta1))}
\NormalTok{     , }\StringTok{"l"}
\NormalTok{     ,}\AttributeTok{main =} \StringTok{"Profile likelihood for beta 1"}
\NormalTok{     ,}\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(beta[}\DecValTok{1}\NormalTok{])}
\NormalTok{     ,}\AttributeTok{ylab =} \StringTok{"lp {-} max(lp)"}
\NormalTok{     ,}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{3.2}\NormalTok{,}\DecValTok{0}\NormalTok{))}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h =} \SpecialCharTok{{-}}\FunctionTok{qchisq}\NormalTok{(}\FloatTok{0.95}\NormalTok{, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =}\NormalTok{ Wald.CI[}\DecValTok{2}\NormalTok{,], }\AttributeTok{col =} \DecValTok{6}\NormalTok{)}
\FunctionTok{text}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Wald.CI[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{]}\SpecialCharTok{+}\FloatTok{0.25}\NormalTok{, }\AttributeTok{y =} \SpecialCharTok{{-}}\FloatTok{1.6}\NormalTok{, }\StringTok{"Wald CI"}\NormalTok{, }\AttributeTok{col =} \DecValTok{6}\NormalTok{)}
\FunctionTok{text}\NormalTok{(}\AttributeTok{x =}\NormalTok{ CI}\FloatTok{.1}\NormalTok{[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{+}\FloatTok{0.09}\NormalTok{, }\AttributeTok{y =} \SpecialCharTok{{-}}\FloatTok{1.7}\NormalTok{, }\StringTok{"CI"}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =} \FunctionTok{c}\NormalTok{(CI}\FloatTok{.1}\NormalTok{),}\AttributeTok{lty =} \StringTok{"dashed"}\NormalTok{, }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-31-1.pdf}

\textbf{(Have not included our analysis based on the weibull
distribution)}

\hypertarget{projekt-3-financial-data}{%
\subsection{Projekt 3: Financial Data}\label{projekt-3-financial-data}}

\hypertarget{descriptive-statistics-and-simple-models}{%
\subsubsection{Descriptive Statistics and Simple
Models}\label{descriptive-statistics-and-simple-models}}

\hypertarget{present-the-data-estimate-the-parameters-in-a-normal-model-and-asses-if-the-normal-model-is-appropriate.}{%
\paragraph{Present the data, estimate the parameters in a normal model,
and asses if the normal model is
appropriate.}\label{present-the-data-estimate-the-parameters-in-a-normal-model-and-asses-if-the-normal-model-is-appropriate.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{D }\OtherTok{\textless{}{-}} \FunctionTok{read.table}\NormalTok{(}\StringTok{"finance\_data.csv"}\NormalTok{, }\AttributeTok{header=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{sep=}\StringTok{";"}\NormalTok{, }
                \AttributeTok{as.is=}\ConstantTok{TRUE}\NormalTok{)}
\DocumentationTok{\#\# Dimensions of D (number of rows and columns)}
\FunctionTok{dim}\NormalTok{(D)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 454   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#  Column/variable names}
\FunctionTok{names}\NormalTok{(D)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "time" "SLV"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# The first rows/observations}
\FunctionTok{head}\NormalTok{(D)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        time          SLV
## 1  2006-5-5  0.013758146
## 2 2006-5-12  0.032857143
## 3 2006-5-19 -0.128630705
## 4 2006-5-26  0.005555556
## 5  2006-6-5 -0.045777427
## 6 2006-6-12 -0.095119934
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# The last rows/observations}
\FunctionTok{tail}\NormalTok{(D)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##          time         SLV
## 449  2015-4-2 -0.01717791
## 450 2015-4-10 -0.01560549
## 451 2015-4-17 -0.01331642
## 452 2015-4-24 -0.03213368
## 453  2015-5-1  0.02722444
## 454  2015-5-8  0.01874596
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Selected summary statistics}
\FunctionTok{summary}\NormalTok{(D)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      time                SLV           
##  Length:454         Min.   :-0.238893  
##  Class :character   1st Qu.:-0.026350  
##  Mode  :character   Median : 0.002226  
##                     Mean   : 0.001468  
##                     3rd Qu.: 0.033122  
##                     Max.   : 0.267308
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Another type of summary of the dataset}
\FunctionTok{str}\NormalTok{(D)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    454 obs. of  2 variables:
##  $ time: chr  "2006-5-5" "2006-5-12" "2006-5-19" "2006-5-26" ...
##  $ SLV : num  0.01376 0.03286 -0.12863 0.00556 -0.04578 ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{D}\SpecialCharTok{$}\NormalTok{date }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{time)}
\NormalTok{D}\SpecialCharTok{$}\NormalTok{year }\OtherTok{\textless{}{-}} \FunctionTok{year}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{date)}

\FunctionTok{ggplot}\NormalTok{(D, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ date, }\AttributeTok{y =}\NormalTok{ SLV)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-32-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ggplot(D, aes(x = SLV)) +}
\CommentTok{\#   geom\_histogram(aes(y = ..density..), color = \textquotesingle{}black\textquotesingle{})}

\NormalTok{par }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{objective =}\NormalTok{ testDistribution,}
              \AttributeTok{distribution =} \StringTok{"normal"}\NormalTok{,}
              \AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\FunctionTok{ggplot}\NormalTok{(D)}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ SLV, }\AttributeTok{y=}\NormalTok{ ..density..,), }\AttributeTok{color=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}\CommentTok{\#color, fill}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dnorm, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{mean =}\NormalTok{ par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{sd =}\NormalTok{ par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]), }\AttributeTok{color=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-32-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# plot(ecdf(D$SLV), verticals = T)}
\CommentTok{\# xseq \textless{}{-} seq(0.9*min(D$SLV), 1.1*max(D$SLV), length.out=100)}
\CommentTok{\# lines(xseq, pnorm(xseq, mean(D$SLV), sd(D$SLV)), col=\textquotesingle{}red\textquotesingle{})}
\CommentTok{\#plot(xseq, pnorm(xseq, mean(D$SLV), sd(D$SLV)), col=\textquotesingle{}red\textquotesingle{})}
\FunctionTok{qqnorm}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{SLV)}
\FunctionTok{qqline}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{SLV)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-32-3.pdf}

\hypertarget{hypothesize-a-model-that-could-fit-the-data-better-hint-consider-tail-probabilities-and-compare-with-the-normal-model-estimated-above}{%
\paragraph{Hypothesize a model that could fit the data better (Hint:
consider tail probabilities), and compare with the normal model
estimated
above}\label{hypothesize-a-model-that-could-fit-the-data-better-hint-consider-tail-probabilities-and-compare-with-the-normal-model-estimated-above}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lcauchyFUNC }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(p, data)\{}
\NormalTok{  x0 }\OtherTok{\textless{}{-}}\NormalTok{ p[}\DecValTok{1}\NormalTok{] }\CommentTok{\#location R}
\NormalTok{  gam }\OtherTok{\textless{}{-}}\NormalTok{ p[}\DecValTok{2}\NormalTok{] }\CommentTok{\#scale R \textgreater{} 0}
  \FunctionTok{return}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{dcauchy}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{location =}\NormalTok{ x0, }\AttributeTok{scale =}\NormalTok{ gam, }\AttributeTok{log =}\NormalTok{ T)))}
\NormalTok{\}}
\NormalTok{lpownormFUNC }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(p, data)\{}
\NormalTok{  alpha }\OtherTok{\textless{}{-}}\NormalTok{ p}
  \FunctionTok{return}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{log}\NormalTok{(}\FunctionTok{dpn}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, p))))}
\NormalTok{\}}
\NormalTok{ltFUNC }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(p, data)\{}
  \FunctionTok{return}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{dt}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{df =}\NormalTok{ p, }\AttributeTok{log =}\NormalTok{ T)))}
\NormalTok{\}}
\NormalTok{lsnFUNC }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(p, data)\{ }\CommentTok{\#skewed normal dist}
  \FunctionTok{return}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{dsn}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{xi =}\NormalTok{ p[}\DecValTok{1}\NormalTok{], }\AttributeTok{omega =}\NormalTok{ p[}\DecValTok{2}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ p[}\DecValTok{3}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)))}
\NormalTok{\}}
\NormalTok{lgnFUNC }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(p, data)\{ }\CommentTok{\#symmetric generalized normal dist}
  \FunctionTok{return}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{dgnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mu =}\NormalTok{ p[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ p[}\DecValTok{2}\NormalTok{], }\AttributeTok{beta =}\NormalTok{ p[}\DecValTok{3}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)))}
\NormalTok{\}}

\NormalTok{lasgnFUNC }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(p, data)\{ }\CommentTok{\#asymmetric generalized normal dist, when K = 0 has already been checked}
\NormalTok{  epsilon }\OtherTok{\textless{}{-}}\NormalTok{ p[}\DecValTok{1}\NormalTok{]}
\NormalTok{  alpha }\OtherTok{\textless{}{-}}\NormalTok{ p[}\DecValTok{2}\NormalTok{]}
\NormalTok{  kappa }\OtherTok{\textless{}{-}}\NormalTok{ p[}\DecValTok{3}\NormalTok{]}
  \FunctionTok{return}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{( }\FunctionTok{log}\NormalTok{(}\FunctionTok{dnorm}\NormalTok{(}\AttributeTok{x =} \SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{kappa }\SpecialCharTok{*} \FunctionTok{log}\NormalTok{(}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ kappa }\SpecialCharTok{*}\NormalTok{ (data }\SpecialCharTok{{-}}\NormalTok{ epsilon) }\SpecialCharTok{/}\NormalTok{ alpha) ) }\SpecialCharTok{/}
\NormalTok{              (alpha }\SpecialCharTok{{-}}\NormalTok{ kappa }\SpecialCharTok{*}\NormalTok{ (data }\SpecialCharTok{{-}}\NormalTok{ epsilon)) ) ) )}
\NormalTok{\}}

\NormalTok{lemgFUNC }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(p, data)\{ }\CommentTok{\#exponential modified gaussian dist}
  \FunctionTok{return}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{demg}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mu =}\NormalTok{ p[}\DecValTok{1}\NormalTok{], }\AttributeTok{sigma =}\NormalTok{ p[}\DecValTok{2}\NormalTok{], }\AttributeTok{lambda =}\NormalTok{ p[}\DecValTok{3}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)))}
\NormalTok{\}}

\NormalTok{par.cauchy }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{objective =}\NormalTok{ lcauchyFUNC, }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\NormalTok{par.pownorm }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \DecValTok{1}\NormalTok{, }\AttributeTok{objective =}\NormalTok{ lpownormFUNC, }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\NormalTok{par.t }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \DecValTok{1}\NormalTok{, }\AttributeTok{objective =}\NormalTok{ ltFUNC, }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\NormalTok{par.sn }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{objective =}\NormalTok{ lsnFUNC, }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\NormalTok{par.gn }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{objective =}\NormalTok{ lgnFUNC, }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Not defined for negative values of alpha and/or beta.
## Not defined for negative values of alpha and/or beta.
## Not defined for negative values of alpha and/or beta.
## Not defined for negative values of alpha and/or beta.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{par.asgn }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{lower =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\ConstantTok{Inf}\NormalTok{, }\SpecialCharTok{{-}}\ConstantTok{Inf}\NormalTok{, }\DecValTok{0}\NormalTok{), }\AttributeTok{objective =}\NormalTok{ lasgnFUNC, }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\NormalTok{par.emg }\OtherTok{\textless{}{-}} \FunctionTok{nlminb}\NormalTok{(}\AttributeTok{start =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{lower =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\ConstantTok{Inf}\NormalTok{, }\DecValTok{1}\SpecialCharTok{/}\DecValTok{1000}\NormalTok{, }\DecValTok{1}\SpecialCharTok{/}\DecValTok{1000}\NormalTok{), }\AttributeTok{objective =}\NormalTok{ lemgFUNC, }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}

\FunctionTok{ggplot}\NormalTok{(D)}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ SLV, }\AttributeTok{y=}\NormalTok{ ..density..,), }\AttributeTok{color=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\#color, fill}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dnorm, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{mean =}\NormalTok{ par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{sd =}\NormalTok{ par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{colour =} \StringTok{"norm"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dcauchy, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{location =}\NormalTok{ par.cauchy}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{],}
                                                          \AttributeTok{scale =}\NormalTok{ par.cauchy}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{colour =} \StringTok{"cauchy"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dpn, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{alpha =}\NormalTok{ par.pownorm}\SpecialCharTok{$}\NormalTok{par), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{colour =} \StringTok{"powernorm"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dt, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{df =}\NormalTok{ par.t}\SpecialCharTok{$}\NormalTok{par), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{colour =} \StringTok{"t"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dsn, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{xi =}\NormalTok{ par.sn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{omega =}\NormalTok{ par.sn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{],}
                                                      \AttributeTok{alpha =}\NormalTok{ par.sn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{]), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{colour =} \StringTok{"sn"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dgnorm, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{mu =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{],}
                                                         \AttributeTok{beta =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{]), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{colour =} \StringTok{"gnorm"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ demg, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{mu =}\NormalTok{ par.emg}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{sigma =}\NormalTok{ par.emg}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{],}
                                                       \AttributeTok{lambda =}\NormalTok{ par.emg}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{]), }\FunctionTok{aes}\NormalTok{(}\AttributeTok{colour =} \StringTok{"emg"}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{scale\_colour\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"blue"}\NormalTok{, }\StringTok{"red"}\NormalTok{, }\StringTok{"yellow"}\NormalTok{, }\StringTok{"black"}\NormalTok{, }\StringTok{"pink"}\NormalTok{, }\StringTok{"grey"}\NormalTok{, }\StringTok{"purple"}\NormalTok{))}\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{colour =} \StringTok{"Distribution"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-33-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#legend(\textquotesingle{}topright\textquotesingle{}, legend=c(\textquotesingle{}normal\textquotesingle{}, \textquotesingle{}cauchy\textquotesingle{}, \textquotesingle{}power normal\textquotesingle{}, \textquotesingle{}t\textquotesingle{}), col=c(\textquotesingle{}red\textquotesingle{}, \textquotesingle{}blue\textquotesingle{}, \textquotesingle{}green\textquotesingle{}, \textquotesingle{}yellow\textquotesingle{}))}

\NormalTok{AIC.norm }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{2} \SpecialCharTok{*} \FunctionTok{sum}\NormalTok{(}\FunctionTok{dnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{mean =}\NormalTok{ par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{sd =}\NormalTok{ par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T))}
\SpecialCharTok{+} \DecValTok{2} \SpecialCharTok{*} \FunctionTok{length}\NormalTok{(par}\SpecialCharTok{$}\NormalTok{par)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{AIC.cauchy }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{2} \SpecialCharTok{*} \FunctionTok{sum}\NormalTok{(}\FunctionTok{dcauchy}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{location =}\NormalTok{ par.cauchy}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{],}
                               \AttributeTok{scale =}\NormalTok{ par.cauchy}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{+} \DecValTok{2} \SpecialCharTok{*} \FunctionTok{length}\NormalTok{(par.cauchy}\SpecialCharTok{$}\NormalTok{par)}
\NormalTok{AIC.pownorm }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{2} \SpecialCharTok{*} \FunctionTok{sum}\NormalTok{(}\FunctionTok{log}\NormalTok{(}\FunctionTok{dpn}\NormalTok{(}\AttributeTok{x =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{alpha =}\NormalTok{ par.pownorm}\SpecialCharTok{$}\NormalTok{par)))}
\SpecialCharTok{+} \DecValTok{2} \SpecialCharTok{*} \FunctionTok{length}\NormalTok{(par.pownorm}\SpecialCharTok{$}\NormalTok{par)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{AIC.t }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{2} \SpecialCharTok{*} \FunctionTok{sum}\NormalTok{(}\FunctionTok{dt}\NormalTok{(}\AttributeTok{x=}\NormalTok{D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{df =}\NormalTok{ par.t}\SpecialCharTok{$}\NormalTok{par, }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{+} \DecValTok{2} \SpecialCharTok{*} \FunctionTok{length}\NormalTok{(par.t}\SpecialCharTok{$}\NormalTok{par)}
\NormalTok{AIC.sn }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{2} \SpecialCharTok{*} \FunctionTok{sum}\NormalTok{(}\FunctionTok{dsn}\NormalTok{(}\AttributeTok{x=}\NormalTok{D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{xi =}\NormalTok{ par.sn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{omega =}\NormalTok{ par.sn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ par.sn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{], }
                       \AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{+} \DecValTok{2} \SpecialCharTok{*} \FunctionTok{length}\NormalTok{(par.sn}\SpecialCharTok{$}\NormalTok{par)}
\NormalTok{AIC.gn }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{2} \SpecialCharTok{*} \FunctionTok{sum}\NormalTok{(}\FunctionTok{dgnorm}\NormalTok{(}\AttributeTok{x=}\NormalTok{D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{mu =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{], }\AttributeTok{beta =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{], }
                          \AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{+} \DecValTok{2} \SpecialCharTok{*} \FunctionTok{length}\NormalTok{(par.gn}\SpecialCharTok{$}\NormalTok{par)}
\NormalTok{AIC.asgn }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{2} \SpecialCharTok{*} \FunctionTok{sum}\NormalTok{( }\FunctionTok{log}\NormalTok{(}\FunctionTok{dnorm}\NormalTok{(}\AttributeTok{x =} \SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{par.asgn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{] }\SpecialCharTok{*} \FunctionTok{log}\NormalTok{(}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ par.asgn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ (D}\SpecialCharTok{$}\NormalTok{SLV }\SpecialCharTok{{-}}\NormalTok{ par.asgn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{]) }\SpecialCharTok{/}\NormalTok{ par.asgn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]) ) }\SpecialCharTok{/}
\NormalTok{                            (par.asgn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ par.asgn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ (D}\SpecialCharTok{$}\NormalTok{SLV }\SpecialCharTok{{-}}\NormalTok{ par.asgn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{])) ) ) }\SpecialCharTok{+} \DecValTok{2} \SpecialCharTok{*} \FunctionTok{length}\NormalTok{(par.asgn}\SpecialCharTok{$}\NormalTok{par)}
\NormalTok{AIC.emg }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{2} \SpecialCharTok{*} \FunctionTok{sum}\NormalTok{(}\FunctionTok{demg}\NormalTok{(}\AttributeTok{x=}\NormalTok{D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{mu =}\NormalTok{ par.emg}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{sigma =}\NormalTok{ par.emg}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{], }\AttributeTok{lambda =}\NormalTok{ par.emg}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{], }
                         \AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{+} \DecValTok{2} \SpecialCharTok{*} \FunctionTok{length}\NormalTok{(par.emg}\SpecialCharTok{$}\NormalTok{par)}


\FunctionTok{round}\NormalTok{(}\FunctionTok{rbind}\NormalTok{(AIC.norm, AIC.cauchy, AIC.pownorm, AIC.t, AIC.sn, AIC.gn, AIC.asgn, AIC.emg), }\AttributeTok{digits=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                   [,1]
## AIC.norm    -1463.9996
## AIC.cauchy  -1363.4142
## AIC.pownorm   781.1103
## AIC.t         837.4564
## AIC.sn      -1457.9996
## AIC.gn      -1480.3914
## AIC.asgn    -1458.7443
## AIC.emg     -1461.9880
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n }\OtherTok{\textless{}{-}} \DecValTok{100000} 
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{)) }\CommentTok{\#comparing by means of generating histograms with n = 100000 points for each of the distributions}
\FunctionTok{hist}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(n, }\AttributeTok{mean =}\NormalTok{ par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{sd =}\NormalTok{ par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]))}
\FunctionTok{hist}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{SLV)}
\FunctionTok{hist}\NormalTok{(}\FunctionTok{rsn}\NormalTok{(n, }\AttributeTok{xi =}\NormalTok{ par.sn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{omega =}\NormalTok{ par.sn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ par.sn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{]))}
\FunctionTok{hist}\NormalTok{(}\FunctionTok{rgnorm}\NormalTok{(n, }\AttributeTok{mu =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{], }\AttributeTok{beta =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{]))}
\FunctionTok{hist}\NormalTok{(}\FunctionTok{rcauchy}\NormalTok{(n, }\AttributeTok{location =}\NormalTok{ par.cauchy}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{scale =}\NormalTok{ par.cauchy}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]))}
\FunctionTok{hist}\NormalTok{(}\FunctionTok{remg}\NormalTok{(n, }\AttributeTok{mu =}\NormalTok{ par.emg}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{sigma =}\NormalTok{ par.emg}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{], }\AttributeTok{lambda =}\NormalTok{ par.emg}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{]))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-33-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{)) }\CommentTok{\#comparing by means of their empirical distribution functions}
\FunctionTok{plot}\NormalTok{(}\FunctionTok{ecdf}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{SLV), }\AttributeTok{verticals =}\NormalTok{ T) }
\NormalTok{xseq }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\FloatTok{0.9}\SpecialCharTok{*}\FunctionTok{min}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{SLV), }\FloatTok{1.1}\SpecialCharTok{*}\FunctionTok{max}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{SLV), }\AttributeTok{length.out=}\DecValTok{100}\NormalTok{)}
\CommentTok{\#lines(xseq, pnorm(xseq, mean(D$SLV), sd(D$SLV)), col=\textquotesingle{}red\textquotesingle{})}
\FunctionTok{lines}\NormalTok{(xseq, }\FunctionTok{pnorm}\NormalTok{(xseq, }\AttributeTok{mean =}\NormalTok{ par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{sd =}\NormalTok{ par}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{]), }\AttributeTok{col=}\StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(}\FunctionTok{ecdf}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{SLV), }\AttributeTok{verticals =}\NormalTok{ T)}
\FunctionTok{lines}\NormalTok{(xseq, }\FunctionTok{pgnorm}\NormalTok{(xseq, }\AttributeTok{mu =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{], }\AttributeTok{beta =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{]), }\AttributeTok{col=}\StringTok{\textquotesingle{}green\textquotesingle{}}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(}\FunctionTok{ecdf}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{SLV), }\AttributeTok{verticals =}\NormalTok{ T)}
\FunctionTok{lines}\NormalTok{(xseq, }\FunctionTok{psn}\NormalTok{(xseq, }\AttributeTok{xi =}\NormalTok{ par.sn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{omega =}\NormalTok{ par.sn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ par.sn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{]), }\AttributeTok{col=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-33-3.pdf}

\hypertarget{present-the-final-model-i.e.-relevant-keynumbers-for-the-estimates}{%
\paragraph{Present the final model (i.e.~relevant keynumbers for the
estimates)}\label{present-the-final-model-i.e.-relevant-keynumbers-for-the-estimates}}

First we have the profile likelihoods of the two parameters of the
normal distribution optimized at the start of project 3. This is to
enable comparison with the profile likelihoods of the chosen
distribution which is the generalized normal distribution. Likelihood
based and Wald CIs are also calculated but are not printed till later.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{alpha }\OtherTok{\textless{}{-}} \FloatTok{0.05}
\NormalTok{c }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.5} \SpecialCharTok{*} \FunctionTok{qchisq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha, }\AttributeTok{df =} \DecValTok{1}\NormalTok{))}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\CommentTok{\#likelihood{-}based CI for normal distribution}
\NormalTok{mle.norm }\OtherTok{\textless{}{-}}\NormalTok{ par}\SpecialCharTok{$}\NormalTok{par}

\NormalTok{fun.norm }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(mu, sigma, data)\{}\DocumentationTok{\#\#\#\#\#}
  \FunctionTok{prod}\NormalTok{(}\FunctionTok{dnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mean =}\NormalTok{ mu, }\AttributeTok{sd =}\NormalTok{ sigma, }\AttributeTok{log =}\NormalTok{ F) }\SpecialCharTok{/} \DecValTok{2}\NormalTok{) }\CommentTok{\#to avoid inf{-}values}
\NormalTok{\}}

\NormalTok{l.fun.norm }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(mu, sigma, data)\{}\DocumentationTok{\#\#\#\#\#}
  \FunctionTok{sum}\NormalTok{(}\FunctionTok{dnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mean =}\NormalTok{ mu, }\AttributeTok{sd =}\NormalTok{ sigma, }\AttributeTok{log =}\NormalTok{ T))}
\NormalTok{\}}

\NormalTok{CIfun.norm }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(y, data, }\AttributeTok{mu =}\NormalTok{ T)\{}\DocumentationTok{\#\#\#\#\# T from mean, F for sigma}
  \ControlFlowTok{if}\NormalTok{(mu)\{}
    \FunctionTok{sum}\NormalTok{(}\FunctionTok{dnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mean =}\NormalTok{ mle.norm[}\DecValTok{1}\NormalTok{], }\AttributeTok{sd =}\NormalTok{ mle.norm[}\DecValTok{2}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{{-}}
      \FunctionTok{sum}\NormalTok{(}\FunctionTok{dnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mean =}\NormalTok{ y, }\AttributeTok{sd =}\NormalTok{ mle.norm[}\DecValTok{2}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{{-}} 
      \FloatTok{0.5} \SpecialCharTok{*} \FunctionTok{qchisq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{sum}\NormalTok{(}\FunctionTok{dnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mean =}\NormalTok{ mle.norm[}\DecValTok{1}\NormalTok{], }\AttributeTok{sd =}\NormalTok{ mle.norm[}\DecValTok{2}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{{-}}
      \FunctionTok{sum}\NormalTok{(}\FunctionTok{dnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mean =}\NormalTok{ mle.norm[}\DecValTok{1}\NormalTok{], }\AttributeTok{sd =}\NormalTok{ y, }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{{-}} 
      \FloatTok{0.5} \SpecialCharTok{*} \FunctionTok{qchisq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha, }\AttributeTok{df =} \DecValTok{1}\NormalTok{) }
\NormalTok{  \}}
\NormalTok{\}}
\NormalTok{mus }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.01}\NormalTok{, }\FloatTok{0.013}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.00001}\NormalTok{)}
\NormalTok{mu.norm }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(}\AttributeTok{X =}\NormalTok{ mus, }\AttributeTok{FUN =}\NormalTok{ fun.norm, }\AttributeTok{sigma =}\NormalTok{ mle.norm[}\DecValTok{2}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\FunctionTok{plot}\NormalTok{(mus, mu.norm}\SpecialCharTok{/}\FunctionTok{max}\NormalTok{(mu.norm), }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{type =} \StringTok{"l"}\NormalTok{, }\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(mu)),}
     \AttributeTok{main =} \StringTok{"Parameter value for mean for normal model of SLV"}\NormalTok{)}
\NormalTok{CI.mu.norm }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.norm, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.003}\NormalTok{, mle.norm[}\DecValTok{1}\NormalTok{]), }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{mu =}\NormalTok{ T)}\SpecialCharTok{$}\NormalTok{root,}
                \FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.norm, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(mle.norm[}\DecValTok{1}\NormalTok{], }\FloatTok{0.006}\NormalTok{), }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{mu =}\NormalTok{ T)}\SpecialCharTok{$}\NormalTok{root)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{range}\NormalTok{(mus), c}\SpecialCharTok{*}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}

\NormalTok{sigmas }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\FloatTok{0.033}\NormalTok{, }\FloatTok{0.060}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.00001}\NormalTok{)}
\NormalTok{sigma.norm }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(}\AttributeTok{X =}\NormalTok{ sigmas, }\AttributeTok{FUN =}\NormalTok{ fun.norm, }\AttributeTok{mu =}\NormalTok{ mle.norm[}\DecValTok{1}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\FunctionTok{plot}\NormalTok{(sigmas}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{, sigma.norm}\SpecialCharTok{/}\FunctionTok{max}\NormalTok{(sigma.norm), }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{type =} \StringTok{"l"}\NormalTok{, }\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(sigma}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)),}
     \AttributeTok{main =} \StringTok{"Parameter value for var for normal model of SLV"}\NormalTok{)}
\NormalTok{CI.sigma.norm }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.norm, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.033}\NormalTok{, mle.norm[}\DecValTok{2}\NormalTok{]), }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{mu =}\NormalTok{ F)}\SpecialCharTok{$}\NormalTok{root,}
                   \FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.norm, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(mle.norm[}\DecValTok{2}\NormalTok{], }\FloatTok{0.063}\NormalTok{), }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{mu =}\NormalTok{ F)}\SpecialCharTok{$}\NormalTok{root)}
\NormalTok{CI.sigmasq.norm }\OtherTok{\textless{}{-}}\NormalTok{ CI.sigma.norm}\SpecialCharTok{\^{}}\DecValTok{2}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{range}\NormalTok{(sigmas}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{), c}\SpecialCharTok{*}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-34-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Wald CI for normal distribution}
\NormalTok{n }\OtherTok{\textless{}{-}} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{]}
\NormalTok{H.mu.norm }\OtherTok{\textless{}{-}} \FunctionTok{hessian}\NormalTok{(l.fun.norm, mle.norm[}\DecValTok{1}\NormalTok{], }\AttributeTok{sigma =}\NormalTok{ mle.norm[}\DecValTok{2}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\NormalTok{V.mu.norm }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{H.mu.norm)}
\NormalTok{H.sigma.norm }\OtherTok{\textless{}{-}} \FunctionTok{hessian}\NormalTok{(l.fun.norm, mle.norm[}\DecValTok{2}\NormalTok{], }\AttributeTok{mu =}\NormalTok{ mle.norm[}\DecValTok{1}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\NormalTok{V.sigma.norm }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{H.sigma.norm)}
\NormalTok{wald.mu.norm }\OtherTok{\textless{}{-}}\NormalTok{ mle.norm[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{sqrt}\NormalTok{(V.mu.norm)}
\NormalTok{wald.sigmasq.norm }\OtherTok{\textless{}{-}}\NormalTok{ (mle.norm[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{sqrt}\NormalTok{(V.sigma.norm))}\SpecialCharTok{\^{}}\DecValTok{2}

\NormalTok{mle.norm.sq }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(mle.norm[}\DecValTok{1}\NormalTok{], mle.norm[}\DecValTok{2}\NormalTok{]}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Profile likelihoods of the three parameters of the GENERALIZED normal
distribution which has been chosen as the best distribution in order to
describe the ETF data. Likelihood based and Wald CIs are also calculated
and printed along with those of the normal distribution.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mle.gn }\OtherTok{\textless{}{-}}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par}
\NormalTok{lgnFUNC }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(p, data)\{ }\CommentTok{\#symmetric generalized normal dist}
  \FunctionTok{return}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(}\FunctionTok{dgnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mu =}\NormalTok{ p[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ p[}\DecValTok{2}\NormalTok{], }\AttributeTok{beta =}\NormalTok{ p[}\DecValTok{3}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)))}
\NormalTok{\}}

\NormalTok{fun.Gnorm }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(mu, alpha, beta, data)\{}\DocumentationTok{\#\#\#\#\#}
  \FunctionTok{prod}\NormalTok{(}\FunctionTok{dgnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mu =}\NormalTok{ mu, }\AttributeTok{alpha =}\NormalTok{ alpha, }\AttributeTok{beta =}\NormalTok{ beta, }\AttributeTok{log =}\NormalTok{ F) }\SpecialCharTok{/} \DecValTok{2}\NormalTok{)}\CommentTok{\#to avoid inf{-}values}
\NormalTok{\}}

\NormalTok{l.fun.Gnorm }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(mu, alpha, beta, data)\{}\DocumentationTok{\#\#\#\#\#}
  \FunctionTok{sum}\NormalTok{(}\FunctionTok{dgnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mu =}\NormalTok{ mu, }\AttributeTok{alpha =}\NormalTok{ alpha, }\AttributeTok{beta =}\NormalTok{ beta, }\AttributeTok{log =}\NormalTok{ T))}
\NormalTok{\}}

\NormalTok{CIfun.Gnorm }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(y, data, }\AttributeTok{p =} \StringTok{"mu"}\NormalTok{)\{}\DocumentationTok{\#\#\#\#\# T from mean, F for sigma}
  \ControlFlowTok{if}\NormalTok{(p }\SpecialCharTok{==} \StringTok{"mu"}\NormalTok{)\{}
    \FunctionTok{sum}\NormalTok{(}\FunctionTok{dgnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mu =}\NormalTok{ mle.gn[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ mle.gn[}\DecValTok{2}\NormalTok{], }\AttributeTok{beta =}\NormalTok{ mle.gn[}\DecValTok{3}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{{-}}
      \FunctionTok{sum}\NormalTok{(}\FunctionTok{dgnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mu =}\NormalTok{ y, }\AttributeTok{alpha =}\NormalTok{ mle.gn[}\DecValTok{2}\NormalTok{], }\AttributeTok{beta =}\NormalTok{ mle.gn[}\DecValTok{3}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{{-}} 
      \FloatTok{0.5} \SpecialCharTok{*} \FunctionTok{qchisq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha, }\AttributeTok{df =} \DecValTok{1}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{(p }\SpecialCharTok{==} \StringTok{"alpha"}\NormalTok{) \{}
    \FunctionTok{sum}\NormalTok{(}\FunctionTok{dgnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mu =}\NormalTok{ mle.gn[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ mle.gn[}\DecValTok{2}\NormalTok{], }\AttributeTok{beta =}\NormalTok{ mle.gn[}\DecValTok{3}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{{-}}
      \FunctionTok{sum}\NormalTok{(}\FunctionTok{dgnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mu =}\NormalTok{ mle.gn[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ y, }\AttributeTok{beta =}\NormalTok{ mle.gn[}\DecValTok{3}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{{-}} 
      \FloatTok{0.5} \SpecialCharTok{*} \FunctionTok{qchisq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha, }\AttributeTok{df =} \DecValTok{1}\NormalTok{) }
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{sum}\NormalTok{(}\FunctionTok{dgnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mu =}\NormalTok{ mle.gn[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ mle.gn[}\DecValTok{2}\NormalTok{], }\AttributeTok{beta =}\NormalTok{ mle.gn[}\DecValTok{3}\NormalTok{], }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{{-}}
      \FunctionTok{sum}\NormalTok{(}\FunctionTok{dgnorm}\NormalTok{(}\AttributeTok{x =}\NormalTok{ data, }\AttributeTok{mu =}\NormalTok{ mle.gn[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ mle.gn[}\DecValTok{2}\NormalTok{], }\AttributeTok{beta =}\NormalTok{ y, }\AttributeTok{log =}\NormalTok{ T)) }\SpecialCharTok{{-}} 
      \FloatTok{0.5} \SpecialCharTok{*} \FunctionTok{qchisq}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha, }\AttributeTok{df =} \DecValTok{1}\NormalTok{) }
\NormalTok{  \}}
\NormalTok{\}}
\DocumentationTok{\#\#\#PROFILE likelihoods}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\CommentTok{\#mu}
\NormalTok{mus.gn }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.0055}\NormalTok{, }\FloatTok{0.011}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.00001}\NormalTok{)}
\NormalTok{mu.gn }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(}\AttributeTok{X =}\NormalTok{ mus.gn, }\AttributeTok{FUN =}\NormalTok{ fun.Gnorm, }\AttributeTok{alpha =}\NormalTok{ mle.gn[}\DecValTok{2}\NormalTok{], }\AttributeTok{beta =}\NormalTok{ mle.gn[}\DecValTok{3}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\FunctionTok{plot}\NormalTok{(mus.gn, mu.gn}\SpecialCharTok{/}\FunctionTok{max}\NormalTok{(mu.gn), }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{type =} \StringTok{"l"}\NormalTok{, }\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(mu)),}
     \AttributeTok{main =} \StringTok{"Parameter value for location of generalized normal model of SLV"}\NormalTok{)}
\NormalTok{CI.mu.gn }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.Gnorm, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(}\FunctionTok{min}\NormalTok{(mus.gn), mle.gn[}\DecValTok{1}\NormalTok{]), }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{p =} \StringTok{"mu"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{root,}
                \FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.Gnorm, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(mle.gn[}\DecValTok{1}\NormalTok{], }\FunctionTok{max}\NormalTok{(mus.gn)), }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{p =} \StringTok{"mu"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{root)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{range}\NormalTok{(mus.gn), c}\SpecialCharTok{*}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\CommentTok{\#alpha}
\NormalTok{alphas }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\FloatTok{0.042}\NormalTok{, }\FloatTok{0.062}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.0001}\NormalTok{)}
\NormalTok{alpha.gn }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(}\AttributeTok{X =}\NormalTok{ alphas, }\AttributeTok{FUN =}\NormalTok{ fun.Gnorm, }\AttributeTok{mu =}\NormalTok{ mle.gn[}\DecValTok{1}\NormalTok{], }\AttributeTok{beta =}\NormalTok{ mle.gn[}\DecValTok{3}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\FunctionTok{plot}\NormalTok{(alphas, alpha.gn}\SpecialCharTok{/}\FunctionTok{max}\NormalTok{(alpha.gn), }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{type =} \StringTok{"l"}\NormalTok{, }\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(alpha)),}
     \AttributeTok{main =} \StringTok{"Parameter value for scale for generalized normal model of SLV"}\NormalTok{)}
\NormalTok{CI.alpha.gn }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.Gnorm, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(}\FunctionTok{min}\NormalTok{(alphas), mle.gn[}\DecValTok{2}\NormalTok{]), }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{p =} \StringTok{"alpha"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{root,}
                   \FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.Gnorm, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(mle.gn[}\DecValTok{2}\NormalTok{], }\FunctionTok{max}\NormalTok{(alphas)), }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{p =} \StringTok{"alpha"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{root)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{range}\NormalTok{(alphas), c}\SpecialCharTok{*}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\CommentTok{\#beta}
\NormalTok{betas }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\FloatTok{1.19}\NormalTok{, }\FloatTok{1.59}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.001}\NormalTok{)}
\NormalTok{beta.gn }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(}\AttributeTok{X =}\NormalTok{ betas, }\AttributeTok{FUN =}\NormalTok{ fun.Gnorm, }\AttributeTok{mu =}\NormalTok{ mle.gn[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ mle.gn[}\DecValTok{2}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\FunctionTok{plot}\NormalTok{(betas, beta.gn}\SpecialCharTok{/}\FunctionTok{max}\NormalTok{(beta.gn), }\AttributeTok{col =} \DecValTok{1}\NormalTok{, }\AttributeTok{type =} \StringTok{"l"}\NormalTok{, }\AttributeTok{xlab =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(beta)),}
     \AttributeTok{main =} \StringTok{"Parameter value for shape for generalized normal model of SLV"}\NormalTok{)}
\NormalTok{CI.beta.gn }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.Gnorm, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(}\FunctionTok{min}\NormalTok{(betas), mle.gn[}\DecValTok{3}\NormalTok{]), }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{p =} \StringTok{"beta"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{root,}
                \FunctionTok{uniroot}\NormalTok{(}\AttributeTok{f =}\NormalTok{ CIfun.Gnorm, }\AttributeTok{interval =} \FunctionTok{c}\NormalTok{(mle.gn[}\DecValTok{3}\NormalTok{], }\FunctionTok{max}\NormalTok{(betas)), }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV, }\AttributeTok{p =} \StringTok{"beta"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{root)}
\FunctionTok{lines}\NormalTok{(}\FunctionTok{range}\NormalTok{(betas), c}\SpecialCharTok{*}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{col =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-35-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Wald CIs}
\NormalTok{n }\OtherTok{\textless{}{-}} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{]}
\NormalTok{H.mu.gn }\OtherTok{\textless{}{-}} \FunctionTok{hessian}\NormalTok{(l.fun.Gnorm, mle.gn[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ mle.gn[}\DecValTok{2}\NormalTok{], }\AttributeTok{beta =}\NormalTok{ mle.gn[}\DecValTok{3}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\NormalTok{V.mu.gn }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{H.mu.gn)}
\NormalTok{H.alpha.gn }\OtherTok{\textless{}{-}} \FunctionTok{hessian}\NormalTok{(l.fun.Gnorm, mle.gn[}\DecValTok{2}\NormalTok{], }\AttributeTok{mu =}\NormalTok{ mle.gn[}\DecValTok{1}\NormalTok{], }\AttributeTok{beta =}\NormalTok{ mle.gn[}\DecValTok{3}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\NormalTok{V.alpha.gn }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{H.alpha.gn)}
\NormalTok{H.beta.gn }\OtherTok{\textless{}{-}} \FunctionTok{hessian}\NormalTok{(l.fun.Gnorm, mle.gn[}\DecValTok{3}\NormalTok{], }\AttributeTok{mu =}\NormalTok{ mle.gn[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ mle.gn[}\DecValTok{3}\NormalTok{], }\AttributeTok{data =}\NormalTok{ D}\SpecialCharTok{$}\NormalTok{SLV)}
\NormalTok{V.beta.gn }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{H.beta.gn)}
\NormalTok{wald.mu.gn }\OtherTok{\textless{}{-}}\NormalTok{ mle.gn[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{sqrt}\NormalTok{(V.mu.gn)}
\NormalTok{wald.alpha.gn }\OtherTok{\textless{}{-}}\NormalTok{ mle.gn[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{sqrt}\NormalTok{(V.alpha.gn)}
\NormalTok{wald.beta.gn }\OtherTok{\textless{}{-}}\NormalTok{ mle.gn[}\DecValTok{3}\NormalTok{] }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{sqrt}\NormalTok{(V.beta.gn)}

\CommentTok{\#CIs normal model}
\FunctionTok{round}\NormalTok{( }\FunctionTok{rbind}\NormalTok{(CI.mu.norm, wald.mu.norm, CI.sigmasq.norm, wald.sigmasq.norm, mle.norm.sq), }\AttributeTok{digits =} \DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                       [,1]    [,2]
## CI.mu.norm        -0.00300 0.00591
## wald.mu.norm      -0.00297 0.00591
## CI.sigmasq.norm    0.00205 0.00266
## wald.sigmasq.norm  0.00204 0.00264
## mle.norm.sq        0.00147 0.00233
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#CIs gnorm model}
\FunctionTok{round}\NormalTok{( }\FunctionTok{rbind}\NormalTok{(CI.mu.gn, wald.mu.gn, CI.alpha.gn, wald.alpha.gn, CI.beta.gn, wald.beta.gn), }\AttributeTok{digits=}\DecValTok{5}\NormalTok{);}\FunctionTok{round}\NormalTok{(}\FunctionTok{rbind}\NormalTok{ (mle.gn), }\AttributeTok{digits =} \DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                   [,1]    [,2]
## CI.mu.gn      -0.00209 0.00632
## wald.mu.gn    -0.00229 0.00649
## CI.alpha.gn    0.04812 0.05623
## wald.alpha.gn  0.04790 0.05601
## CI.beta.gn     1.28633 1.50121
## wald.beta.gn   1.25398 1.52790
\end{verbatim}

\begin{verbatim}
##          [,1]    [,2]    [,3]
## mle.gn 0.0021 0.05196 1.39094
\end{verbatim}

Finally the expected value (and 95 \% CI) of the chosen generalized
normal distribution is given below.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{E.gn }\OtherTok{\textless{}{-}}\NormalTok{ mle.gn[}\DecValTok{1}\NormalTok{]}
\NormalTok{V.gn }\OtherTok{\textless{}{-}}\NormalTok{ mle.gn[}\DecValTok{2}\NormalTok{]}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{*} \FunctionTok{gamma}\NormalTok{(}\DecValTok{3}\SpecialCharTok{/}\NormalTok{mle.gn[}\DecValTok{3}\NormalTok{]) }\SpecialCharTok{/} \FunctionTok{gamma}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{mle.gn[}\DecValTok{3}\NormalTok{])}
\NormalTok{CI.E.gn }\OtherTok{\textless{}{-}}\NormalTok{ E.gn }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{qnorm}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{sqrt}\NormalTok{(V.gn }\SpecialCharTok{/}\NormalTok{ n)}
\FunctionTok{rbind}\NormalTok{(E.gn);}\FunctionTok{rbind}\NormalTok{(CI.E.gn)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            [,1]
## E.gn 0.00210156
\end{verbatim}

\begin{verbatim}
##                 [,1]        [,2]
## CI.E.gn -0.002300743 0.006503863
\end{verbatim}

The final model is compared to the distribution of the weekly returns.
The parameters are shown along with the distribution model.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{temp1 }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"mu == "}\NormalTok{, mle.gn[}\DecValTok{1}\NormalTok{])}
\NormalTok{temp2 }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"alpha == "}\NormalTok{, mle.gn[}\DecValTok{2}\NormalTok{])}
\NormalTok{temp3 }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"beta == "}\NormalTok{, mle.gn[}\DecValTok{3}\NormalTok{])}

\FunctionTok{ggplot}\NormalTok{(D)}\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ SLV, }\AttributeTok{y=}\NormalTok{ ..density..,), }\AttributeTok{color=}\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\#color, fill}
  \FunctionTok{stat\_function}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ dgnorm, }\AttributeTok{n =} \FunctionTok{dim}\NormalTok{(D)[}\DecValTok{1}\NormalTok{], }\AttributeTok{args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{mu =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{], }\AttributeTok{alpha =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{],}
                                                         \AttributeTok{beta =}\NormalTok{ par.gn}\SpecialCharTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{]), }\AttributeTok{color =} \StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{( }\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \FloatTok{2.7}\SpecialCharTok{/}\DecValTok{5}\SpecialCharTok{*}\FunctionTok{max}\NormalTok{(D}\SpecialCharTok{$}\NormalTok{SLV), }\AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\FloatTok{10.5}\NormalTok{, }\FloatTok{10.0}\NormalTok{, }\FloatTok{9.4}\NormalTok{), }\AttributeTok{label =} \FunctionTok{c}\NormalTok{(temp1,temp2,temp3), }\AttributeTok{parse =}\NormalTok{ T  )}\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Generalized normal distribution and distribution of the weekly returns"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment-1_files/figure-latex/unnamed-chunk-37-1.pdf}

\end{document}
